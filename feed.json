{
    "version": "https://jsonfeed.org/version/1",
    "title": "学无止境",
    "subtitle": "阿宇的可爱博客",
    "icon": "https://blog.aayu.today/images/favicon.ico",
    "description": "真理和热爱是吾永生的追求",
    "home_page_url": "https://blog.aayu.today",
    "items": [
        {
            "id": "https://blog.aayu.today/english/reading/20220619/",
            "url": "https://blog.aayu.today/english/reading/20220619/",
            "title": "Daily Reading #1: The Capitol-riot hearings: High time for prime time",
            "date_published": "2022-06-18T16:00:00.000Z",
            "content_html": "<h2 id=\"文章来源\"><a class=\"anchor\" href=\"#文章来源\">#</a> 文章来源</h2>\n<p>The Economist: June 11th - 17th 2022</p>\n<h2 id=\"标题\"><a class=\"anchor\" href=\"#标题\">#</a> 标题</h2>\n<p>The Capitol-riot hearings: High time for prime time 国会暴动听证会：黄金时间的到来</p>\n<p>Why America’s probe into the attempted coup last year is needed, before it’s too late 为什么美国需要对去年的未遂政变进行调查，否则就太晚了</p>\n<p><img data-src=\"http://image.aayu.today/2022/06/19/1f9cc6772ee8f.png\" alt=\"\" /></p>\n<h2 id=\"全文速览\"><a class=\"anchor\" href=\"#全文速览\">#</a> 全文速览</h2>\n<div class=\"tab\" data-id=\"id1\" data-title=\"英文全文\">\n<p>The essence of what happened on January 6th 2021 is well-known, if still shocking to recall. A mob stormed the Capitol in Washington, dc, in an effort to prevent Congress from certifying Joe Biden’s election victory. Four people in the crowd died that day, and five police officers in its aftermath. Members of Congress had to be rushed to a secure location in a basement. Rioters erected a mock gallows and chanted “Hang Mike Pence”. And the man who inspired all this was the president himself, who had urged his followers to help overturn his election defeat. As the Republicans’ leader in the Senate, Mitch McConnell, told the Senate a few weeks later, Donald Trump was “practically and morally responsible” for these events: “The people who stormed this building believed they were acting on the wishes and instructions of their president.”</p>\n<p>So what is the point of the public hearings of the House committee probing the insurrection due to start on June 9th? From Thursday’s prime-time political theatre to half a dozen sessions that will follow before a final report in September, the coverage will be viewed very differently on either side of a polarised country. Commentators on the right will belittle it all as a witch hunt. And after November’s mid-term elections, in which the Republicans look likely to win control of the House, they can be counted on to bury the matter.</p>\n<p>Yet that ticking clock gives an urgency to the proceedings, which matter profoundly, for three reasons. One flows from the basic workings of democracy: institutions must do their job. It is the task of Congress to probe how an assault on the Capitol happened and conclude what lessons can be learned. Its nine-member committee—seven Democrats and two principled Republicans, Liz Cheney and Adam Kinzinger—has gone about it in a commendably thorough, bipartisan way, despite much resistance. On June 3rd the Department of Justice charged Peter Navarro, a former economic adviser to Mr Trump, for refusing to co-operate with the committee (though it strangely decided not to act against Mark Meadows, the White House chief of staff at the time of the riot, despite similar obstructionism).</p>\n<p>Second, though the core of the story is known, many vital details are not—especially concerning the extent of the coup’s planning and how directly the president was involved. Some revealing details, such as text messages from Mr Trump’s family to Mr Meadows urging him to persuade his boss to stop the riot, have dribbled out in the course of the committee’s work so far. More can be expected in the public hearings, given that they will draw on information gleaned from more than 1,000 depositions and interviews and over 140,000 documents.</p>\n<p>A flow of fresh facts about the depth of plotting would reinforce the third reason why these hearings are important: the threat is not over. True, America’s democracy prevailed despite the attack. Members of Congress were eventually able to go back into the chamber and they duly certified the election (albeit that, despite the violence that had occurred that day, 138 Republican House members still voted to reject the results in Pennsylvania). Mr Biden became president. But even now 60% of Republicans believe Mr Trump’s lie that the election was stolen. And the party has decided that the insurrection was not serious enough to break with Mr Trump, leaving him the front-runner for the Republican nomination in 2024. If Republicans select him, Mr McConnell says he will back him.</p>\n<p>Astonishing as it may seem, given what is already known about his efforts to thwart the will of the electorate, let alone what may be discovered, Mr Trump could well win back the presidency legitimately. In case he does not, his supporters are striving to put in place officials who may make a future challenge to the voters’ verdict succeed. The committee’s work, including the public hearings, is a vital part of the eternal vigilance that, more than ever, is needed to defend American democracy.</p>\n</div>\n<div class=\"tab\" data-id=\"id1\" data-title=\"中文翻译\">\n<p>2021 年 1 月 6 日发生的事情的本质是众所周知的，如果回忆起来仍然令人震惊。一群暴徒冲进华盛顿特区的国会大厦，试图阻止国会认证乔 - 拜登的选举胜利。当天，人群中有 4 人死亡，5 名警察在事后死亡。国会议员不得不被紧急送往地下室的一个安全地点。骚乱者搭建了一个模拟绞架，并高呼 &quot;绞死迈克 - 彭斯&quot;。而激发这一切的人就是总统本人，他曾敦促他的追随者帮助推翻他的选举失败。正如共和党在参议院的领导人米奇 - 麦康奈尔几周后告诉参议院的那样，唐纳德 - 特朗普对这些事件 &quot;实际上和道德上都有责任&quot;。&quot;冲进这座大楼的人认为他们是按照他们的总统的意愿和指示行事。&quot;</p>\n<p>那么，将于 6 月 9 日开始的众议院委员会调查叛乱的公开听证会的意义何在？从周四的黄金时段的政治戏剧到随后的半打会议，再到 9 月的最终报告，在这个两极分化的国家里，人们对这些报道的看法会非常不同。右派的评论员会把这一切贬低为猎奇。而在 11 月的中期选举之后，共和党看起来有可能赢得对众议院的控制权，可以指望他们将此事埋葬。</p>\n<p>然而，这个滴答作响的钟声给这个程序带来了紧迫感，它关系重大，原因有三。一个原因来自于民主的基本运作：机构必须做好自己的工作。国会的任务是调查对国会大厦的攻击是如何发生的，并总结出可以吸取的教训。其九名成员组成的委员会 -- 七名民主党人和两名有原则的共和党人利兹 - 切尼和亚当 - 金辛格 -- 以值得称道的彻底、两党合作的方式进行调查，尽管有很多阻力。6 月 3 日，司法部指控特朗普先生的前经济顾问彼得 - 纳瓦罗 (Peter Navarro) 拒绝与委员会合作（但奇怪的是，尽管有类似的阻挠行为，司法部还是决定不对骚乱发生时的白宫幕僚长马克 - 梅多斯 (Mark Meadows) 采取行动）。</p>\n<p>第二，虽然故事的核心内容已经知道，但许多重要的细节并不清楚，特别是关于政变的计划程度以及总统如何直接参与。在委员会迄今为止的工作过程中，一些具有启发性的细节，如特朗普先生的家人给梅多斯先生的短信，敦促他劝说他的老板停止暴乱，已经流传出来。鉴于公开听证会将利用从 1000 多份证词和访谈以及 14 万多份文件中收集到的信息，可以预期会有更多的细节。</p>\n<p>关于阴谋深度的新事实的流动将加强这些听证会重要的第三个原因：威胁并没有结束。诚然，尽管发生了袭击，美国的民主还是取得了胜利。国会议员最终能够回到会议厅，他们正式认证了选举（尽管当天发生了暴力事件，但仍有 138 名共和党众议员投票反对宾夕法尼亚州的选举结果）。拜登先生成为总统。但即使是现在，也有 60% 的共和党人相信特朗普先生的谎言，即选举被盗。而该党已经决定，叛乱还没有严重到与特朗普先生决裂的地步，让他成为 2024 年共和党提名的领跑者。如果共和党人选择他，麦康奈尔先生说他会支持他。</p>\n<p>尽管看起来令人吃惊，但考虑到他阻挠选民意愿的努力已经为人所知，更不用说可能发现的情况，特朗普先生很可能合法地赢回总统职位。如果他不这样做，他的支持者正在努力安排一些官员，他们可能会使未来对选民裁决的挑战取得成功。委员会的工作，包括公开听证会，是捍卫美国民主比以往任何时候都更需要的永恒的警惕的重要组成部分。</p>\n</div>\n<h2 id=\"长难句分析\"><a class=\"anchor\" href=\"#长难句分析\">#</a> 长难句分析</h2>\n<p>待更</p>\n",
            "tags": [
                "英语学习之路",
                "每日精读",
                "每日精读"
            ]
        },
        {
            "id": "https://blog.aayu.today/leisure/mood/20220519/",
            "url": "https://blog.aayu.today/leisure/mood/20220519/",
            "title": "DIY的一个超好看的小夜灯",
            "date_published": "2022-05-18T16:00:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>最近在 B 站上看到一个 DIY 小夜灯的教程，实物真的要比照片好看～～</p>\n<p>520 要到啦，自己 DIY 一个送给对象，是个很不错的礼物～～</p>\n<h2 id=\"小夜灯\"><a class=\"anchor\" href=\"#小夜灯\">#</a> 小夜灯</h2>\n<p><img data-src=\"http://image.aayu.today/2022/05/19/7a917a89b6e39.jpg\" alt=\"\" /></p>\n<h2 id=\"教程链接\"><a class=\"anchor\" href=\"#教程链接\">#</a> 教程链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMXNVNHkxYzdOeQ==\">成本 20 手把手教：3D 打印有趣的小夜灯，超级好看！大鱼 DIY 原创，含资料图纸！</span></li>\n</ul>\n",
            "tags": [
                "清风明月",
                "心情",
                "心情"
            ]
        },
        {
            "id": "https://blog.aayu.today/hardware/raspberry-pi/20220516/",
            "url": "https://blog.aayu.today/hardware/raspberry-pi/20220516/",
            "title": "树莓派4B安装向日葵踩坑笔记",
            "date_published": "2022-05-15T16:00:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>近期在捣鼓树莓派，已经在树莓派上成功用 VNC 进行了远程桌面连接，那么便想尝试能否用向日葵连接树莓派，这一尝试便踩了不少坑，而且国内关于这方面的资料也挺少，于是便把自己的踩坑经历记录下来～</p>\n<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<p>我用的是完整版的 Raspberry Pi OS 64 位系统，注意是 64 位系统哦，可以用上海交通大学 SJTUG 镜像站下载，下载速度很快，链接如下～</p>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9taXJyb3JzLnNqdHVnLnNqdHUuZWR1LmNuL3Jhc3BiZXJyeS1waS1vcy1pbWFnZXMvcmFzcGlvc19mdWxsX2FybTY0L2ltYWdlcy8=\">Raspberry Pi OS 64</span></p>\n<p>更多镜像的下载链接和介绍可以看这篇博文：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E0OTYyOTg2ODUvYXJ0aWNsZS9kZXRhaWxzLzEwODkwOTkyNw==\">使用国内镜像站下载树莓派 Raspberry Pi OS 操作系统</span></p>\n<p>最终烧录好的系统如下</p>\n<pre><code>Linux raspberrypi 5.15.32-v8+ #1538 SMP PREEMPT Thu Mar 31 19:40:39 BST 2022 aarch64 GNU/Linux\n</code></pre>\n<h2 id=\"下载安装包\"><a class=\"anchor\" href=\"#下载安装包\">#</a> 下载安装包</h2>\n<p>去向日葵的官网下载 Linux 的安装包</p>\n<p>因为我们的系统是 arm64 位的，而向日葵的「UOS」和「麒麟」这两个应用平台提供 arm64 版本的架构，这里我选择「麒麟」应用平台的 arm64 版本安装包</p>\n<p>下载完安装包后就可以在树莓派里用如下命令安装</p>\n<pre><code>sudo dpkg -i SunloginClient_11.0.1.44968_kylin_arm.deb\n</code></pre>\n<p>但会发现报错，报错如下</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/16/b3fa5e9133894.png\" alt=\"\" /></p>\n<p>从报错信息中可以，缺少  <code>libappindicator3-1</code>  这个依赖包</p>\n<h2 id=\"解决缺少依赖问题\"><a class=\"anchor\" href=\"#解决缺少依赖问题\">#</a> 解决缺少依赖问题</h2>\n<p>首先尝试用  <code>sudo apt-get install libappindicator3-1</code>  去安装依赖，发现源里没有这个依赖包</p>\n<p>没办法，那就直接下载好这个依赖包然后手动安装吧，经过查阅资料，从 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTQ0NzQ3Ny9hcnRpY2xlL2RldGFpbHMvMTE1MTg4OTM4\">这篇博客中</span> 找到了相关的下载链接</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL21pcnJvcnMudXN0Yy5lZHUuY24vZGViaWFuL3Bvb2wvbWFpbi9saWJhL2xpYmFwcGluZGljYXRvci8=\">libappindicator3-1 官方下载链接</span></p>\n<p>我们找到 arm64 架构的进行下载，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/16/0ac959820f764.png\" alt=\"\" /></p>\n<p>下载完成后先用  <code>sudo apt --fix-broken install</code>  命令进行依赖包错误的修复，然后再用  <code>sudo dpkg -i libappindicator3-1_0.4.92-7_arm64.deb</code>  安装刚刚下载好的依赖包</p>\n<p>结果事与愿违，依然报错啦，报错截图如下</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/16/fb0a62fe6909f.png\" alt=\"\" /></p>\n<p>可以看到还缺少了  <code>libdbusmenu-glib4</code> ， <code>libdbusmenu-gtk3-4</code> ， <code>libindicator3-7</code>  这三个依赖包</p>\n<p>好吧，那再次尝试把这三个依赖包看能不能安装上吧，还是先用  <code>sudo apt --fix-broken install</code>  命令进行依赖包错误的修复，然后尝试看本地源里有无依赖包，终于来好运了，本地源里有  <code>libdbusmenu-glib4</code> ， <code>libdbusmenu-gtk3-4</code>  这两个依赖包，用如下命令安装</p>\n<pre><code>sudo apt-get install libdbusmenu-glib4\nsudo apt-get install libdbusmenu-gtk3-4\n</code></pre>\n<p>在尝试用本地源安装  <code>libindicator3-7</code>  时发现没有，那就还是自己下载依赖包手动安装吧，下载链接如下</p>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL21pcnJvcnMudXN0Yy5lZHUuY24vZGViaWFuL3Bvb2wvbWFpbi9saWJpL2xpYmluZGljYXRvci8=\">libindicator3-7 官方下载链接</span></p>\n<p>我们依然选择 arm64 架构的进行下载，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/16/c8f687dd6d8f7.png\" alt=\"\" /></p>\n<p>下载好后就可以用  <code>sudo dpkg -i libindicator3-7_0.5.0-4_arm64.deb</code>  命令进行安装啦</p>\n<p>终于把这三个依赖包都安装好了，然后再次用  <code>sudo dpkg -i libappindicator3-1_0.4.92-7_arm64.deb</code>  安装最开始报错的依赖包，结果终于不报错啦，接下来终于可以尝试再次安装向日葵的安装包啦，安装命令如下</p>\n<pre><code>sudo dpkg -i SunloginClient_11.0.1.44968_kylin_arm.deb\n</code></pre>\n<p>终于，安装成功！结果如下</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/16/c92d4247ba514.png\" alt=\"\" /></p>\n<h2 id=\"启动向日葵\"><a class=\"anchor\" href=\"#启动向日葵\">#</a> 启动向日葵</h2>\n<p>在树莓派上终于安好向日葵了，那向日葵怎么启动呢，可以在菜单栏里找到向日葵，如下</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/16/907d31ab2f6c1.png\" alt=\"\" /></p>\n<p>成功运行向日葵，如下～～</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/16/b2742e182bbd4.png\" alt=\"\" /></p>\n<h2 id=\"相关链接\"><a class=\"anchor\" href=\"#相关链接\">#</a> 相关链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E0OTYyOTg2ODUvYXJ0aWNsZS9kZXRhaWxzLzEwODkwOTkyNw==\">使用国内镜像站下载树莓派 Raspberry Pi OS 操作系统</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTQ0NzQ3Ny9hcnRpY2xlL2RldGFpbHMvMTE1MTg4OTM4\">无法定位软件包：libappindicator3-1_libappindicator3-1 软件包安装失败</span></li>\n</ul>\n",
            "tags": [
                "硬件修炼手册",
                "树莓派",
                "RaspberryPi"
            ]
        },
        {
            "id": "https://blog.aayu.today/skill/tools/20220510/",
            "url": "https://blog.aayu.today/skill/tools/20220510/",
            "title": "NoteExpress七个隐藏的实用技巧",
            "date_published": "2022-05-10T11:50:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>NoteExpress 可以说是国内最专业的文献检索与管理系统了，对比 Endnote 来说，它最大的优点是对中文文献管理非常友好！对于需要发中文核心的科研人员来说，特别推荐！</p>\n<h2 id=\"笔记添加\"><a class=\"anchor\" href=\"#笔记添加\">#</a> 笔记添加</h2>\n<p>在预览区的倒数第 2 个位置就是「笔记」选项卡，在这里可以做笔记。各栏位置可以用鼠标拖动进行调整。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/883b8b000400e.png\" alt=\"\" /></p>\n<p>笔记不仅可以插入文字，还可以插入图片和表格。</p>\n<p>文字插入大家应该都会，不需要多讲；</p>\n<p>关于图片、表格以及一些超链接的插入，只需要点击相应的图标，然后在文件夹里选中需要插入的内容就可以了！最后，点击「保存」这个图标就可以了。</p>\n<p>一旦有笔记加入，会出现粉红色方框，这就代表笔记已经存在了。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/209f42b041519.png\" alt=\"\" /></p>\n<p>这对我们之后查找文件帮助很大，打开文件看到特定的小红点就知道是自己想要的内容，不需要费时寻找。</p>\n<h2 id=\"文献去重\"><a class=\"anchor\" href=\"#文献去重\">#</a> 文献去重</h2>\n<p>我们在众多数据库中进行检索添加参考文献记录，不可避免的会有重复的文献。这种情况下，可以直接用 NoteExpress 进行查找去重。</p>\n<p>操作步骤也非常简单：</p>\n<p>选中左上角菜单栏的「查重」按钮，根据需要选择想要查重的文件夹和筛选条件，点击「查找」。此时，NoteExpress 会显示我们上一步筛选出来的重复文献，且左侧检索记录会记录下每一次查重的结果。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/bd99341b3a272.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/cf8a519300b5b.png\" alt=\"\" /></p>\n<p>这时，重复的文献就会被选中，呈现深蓝色的背景颜色啦</p>\n<p>我们可以单击单篇文献，点击预览区的「位置」按钮，便可查看文献所处数据库或者文件夹的位置。</p>\n<p>根据需要，将重复文献从不必要的数据库当中删除即可。</p>\n<p>操作方式是：右键文献，选择「从所有文件夹中删除」或者「从指定文件夹中删除」。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/bd8e81799c1d8.png\" alt=\"\" /></p>\n<h2 id=\"标签标记\"><a class=\"anchor\" href=\"#标签标记\">#</a> 标签标记</h2>\n<p>该功能主要支持给文献添加标签，一篇文献可添加多个标签。添加之后方便文献的管理。</p>\n<p>操作方式是：选中文献，点击左上角的「标签标记」，添加合适的标签、星标或优先级，点击「确定」即可。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/aecc19871b5f9.png\" alt=\"\" /></p>\n<p>此时的标签云是一个超链接，点击词组标签可以跳到相应的文件（或者显示多个文件），也可点击向下的小三角对标签进行排序或隐藏。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/685ba7141df5d.png\" alt=\"\" /></p>\n<h2 id=\"文献阅读\"><a class=\"anchor\" href=\"#文献阅读\">#</a> 文献阅读</h2>\n<p>这是对前面一些小技巧汇了一个总，这里我把题录分成了 9 个部分。</p>\n<p>① 表示是否阅读了文献；</p>\n<p>② 表示文献类型，比如说有学位论文或者是期刊文章；</p>\n<p>③ 已经加星标，将其收藏；</p>\n<p>④ 代表优先级，这个优先级有 5 个档次；</p>\n<p>⑤ 有无附件、红色方块显示有附件，没有方块则代表没有附件；</p>\n<p>⑥ 到 ⑨ 就是年份作者标题和来源，这个暂时不多讲。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/4bdd582ed5a45.png\" alt=\"\" /></p>\n<p>值得注意的是，这些选项就可以作为筛选条件来对其进行排序，我们只需要选择想要筛选的条件那里，点一下，就可以排序了。</p>\n<p>当然，还可以自定义列表头。有以下两种方法，都很简单实用。</p>\n<p>第一种：「文件夹」上右键 -「自定义列表头」-「自定义」；</p>\n<p>或者第二种方法：列表头上面右键，选择「自定义」即可。</p>\n<h2 id=\"文献统计分析\"><a class=\"anchor\" href=\"#文献统计分析\">#</a> 文献统计分析</h2>\n<p>没想到吧，NoteExpress 还提供了对文献记录的基本统计功能。</p>\n<p>操作方式是：</p>\n<p>选中需要统计的数据库，再选择「文件夹信息统计」-「统计题录类型」（例如对当前数据库文献记录题录类型、 第一作者、第二作者、卷、 期、引用次数以及关键词等），最后点击「统计」即可。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/10/01f7cede6c33b.png\" alt=\"\" /></p>\n<p>如，对当前数据库文献记录来源的年份进行分析，可以了解当前文献的来源近况，这样，点击「年份」后就会出现分析结果，可以将统计结果另存为文本格式。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/11/1741884409216.png\" alt=\"\" /></p>\n<h2 id=\"压缩数据库\"><a class=\"anchor\" href=\"#压缩数据库\">#</a> 压缩数据库</h2>\n<p>如果文献太多，已经没有多余的空间了，这个时候建议使用「压缩当前数据库」的功能。</p>\n<p>且该功能可以多次使用，如果经过一段时间使用，数据库又没有冗余空间可继续使用该功能。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/11/2d5605f31976e.png\" alt=\"\" /></p>\n<h2 id=\"工具选项\"><a class=\"anchor\" href=\"#工具选项\">#</a> 工具选项</h2>\n<p>「工具选项」可以对常规、显示、数据库备份、笔记、扩展、样式、网络代理、自定义、用户以及其他等进行设置。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/11/8f7cb5587acfc.png\" alt=\"\" /></p>\n<p>这里我们着重讲一下「扩展」的设置，这里面描述了如何设置 Word 与 WPS 的插件，也即是说将 Noteexpress 选项卡存放在 Word 或者 WPS 的菜单栏。</p>\n<p>一般情况下，安装完 Noteexpress ，会自动在 Word 中加载该扩展，WPS 中也能加载该扩展，两个软件都并未出现不兼容的情况，使用感受也都差不多，可以按照个人习惯选择。</p>\n<p>假如未能显示，或者其他未知的错误，可以点击这里的按钮重装一次 。</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/11/042a23eb537ec.png\" alt=\"\" /></p>\n<p>还有自定义选项。我们可以在这个地方，对题录的字段自定义，也可以对列表头自定义。这样就可以更加方便、自如地管理我们的文献了！</p>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8yODA3MDczNTI=\">中文文献管理神器的 7 个隐藏的实用技巧…</span></li>\n</ul>\n",
            "tags": [
                "不看会后悔的实用技巧分享",
                "工具篇",
                "NoteExpress"
            ]
        },
        {
            "id": "https://blog.aayu.today/skill/miscellaneous/20220508/",
            "url": "https://blog.aayu.today/skill/miscellaneous/20220508/",
            "title": "常见文档打开乱码原因总结",
            "date_published": "2022-05-08T09:07:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>本文总结了一些常见的因为编码设置错误而打开文档乱码的情况</p>\n<p><img data-src=\"http://image.aayu.today/2022/05/08/196501abc3a9f.jpg\" alt=\"\" /></p>\n",
            "tags": [
                "不看会后悔的实用技巧分享",
                "杂七杂八",
                "乱码"
            ]
        },
        {
            "id": "https://blog.aayu.today/gis/cesium/learning-notes/20220421/",
            "url": "https://blog.aayu.today/gis/cesium/learning-notes/20220421/",
            "title": "Vue3.2配置Cesium踩坑笔记",
            "date_published": "2022-04-21T04:05:21.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>很早之前，我写过一篇 <a href=\"https://blog.aayu.today/gis/cesium/learning-notes/20210701/\">Cesium-Vue3 整合 Cesium 最简教程</a> 教程，而最近我在学习最新版的 Vue3.2 和 TypeScript，并使用了 Vue Admin Plus 后台框架，发现在这个框架的基础上配置 Cesium 会有一些坑，便在此记录下来，希望能帮助到后面的小伙伴呀～～</p>\n<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<ul>\n<li>NodeJS：16.14.2</li>\n<li>Vue：3.2.31</li>\n<li>Cesium：1.92.0</li>\n<li>@types/cesium：1.70.0</li>\n<li>copy-webpack-plugin：10.2.4</li>\n<li>@types/copy-webpack-plugin：10.1.0</li>\n</ul>\n<h2 id=\"配置步骤\"><a class=\"anchor\" href=\"#配置步骤\">#</a> 配置步骤</h2>\n<ol>\n<li>安装相关依赖</li>\n</ol>\n<p>因为我是在现有 Vue Admin Plus 后台框架的基础上配置 Cesium 的，所以就省略了新建项目的步骤，直接安装依赖，如下</p>\n<pre><code>cnpm install Cesium\ncnpm install @types/cesium\ncnpm install copy-webpack-plugin -D\ncnpm install @types/copy-webpack-plugin -D\n</code></pre>\n<p>这里我用 cnpm 安装，是因为 Vue Admin Plus 这个框架依赖就是用 cnpm 安装的，用 npm 安装可能会报  <code>Error: command failed: npm install --loglevel error</code>  的错误～～</p>\n<p>安装 cnpm 可以用如下命令安装</p>\n<pre><code># powershell 管理员模式安装\nnpm install cnpm -g --registry=https://registry.npmmirror.com\n\n# powershell 获取管理员权限，选择A\nset-ExecutionPolicy RemoteSigned\n</code></pre>\n<ol start=\"2\">\n<li>配置 vue.config.js 文件</li>\n</ol>\n<p>因为我用的  <code>copy-webpack-plugin</code>  是最新版的，而最新版的导入语法有点变化，所以参考 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI3NjAxNy9hcnRpY2xlL2RldGFpbHMvMTE5Mzc5OTY3\">这篇博文</span> 的配置要有点变化，更改后如下</p>\n<figure class=\"highlight ts\"><figcaption data-lang=\"TypeScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">new</span> <span class=\"token class-name\">CopyWebpackPlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    patterns<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            from<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>cesiumSource<span class=\"token punctuation\">,</span> <span class=\"token string\">'Workers'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            to<span class=\"token operator\">:</span> <span class=\"token string\">'Workers'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            from<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>cesiumSource<span class=\"token punctuation\">,</span> <span class=\"token string\">'Assets'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            to<span class=\"token operator\">:</span> <span class=\"token string\">'Assets'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            from<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>cesiumSource<span class=\"token punctuation\">,</span> <span class=\"token string\">'Widgets'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            to<span class=\"token operator\">:</span> <span class=\"token string\">'Widgets'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            from<span class=\"token operator\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>cesiumSource<span class=\"token punctuation\">,</span> <span class=\"token string\">'ThirdParty/Workers'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            to<span class=\"token operator\">:</span> <span class=\"token string\">'ThirdParty/Workers'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">new</span> <span class=\"token class-name\">webpack</span><span class=\"token punctuation\">.</span><span class=\"token function\">DefinePlugin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token constant\">CESIUM_BASE_URL</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><ol start=\"3\">\n<li>配置 main.ts 文件</li>\n</ol>\n<p>如果按照下面这样导入</p>\n<figure class=\"highlight ts\"><figcaption data-lang=\"TypeScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @description 导入 Cesium</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string\">'cesium/Source/Widgets/widgets.css'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">const</span> Cesium <span class=\"token operator\">=</span> <span class=\"token keyword\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cesium/Source/Cesium'</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>会报错找不到模块的，如下</p>\n<pre><code> error  in ./src/main.ts\n\nModule not found: Error: Package path ./Source/Widgets/widgets.css is not exported from package E:\\code\\javascript\\city-analysis-platform\\node_modules\\cesium (see exports field in E:\\code\\javascript\\city-analysis-platform\\node_modules\\cesium\\package.json)\n\n error  in ./src/main.ts\n\nModule not found: Error: Package path ./Source/Cesium is not exported from package E:\\code\\javascript\\city-analysis-platform\\node_modules\\cesium (see exports field in E:\\code\\javascript\\city-analysis-platform\\node_modules\\cesium\\package.json)\n</code></pre>\n<p>在查阅了一番资料后，终于参考了这篇：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wcm9ncmFtbWVyLmluay90aGluay93aHktZGlkLWl0LWZhaWwtdG8taW1wb3J0LWNzcy1vZi1jZXNpdW0taW4tdGhlLXBhY2thZ2luZy10b29sLmh0bWw=\">Why did it fail to import css of Cesium in the packaging tool</span> 找到了解决办法～～</p>\n<p>解决办法就是首先在  <code>node_modules/cesium</code>  目录下找到它的  <code>package.json</code>  文件，然后修改 exports 字段如下</p>\n<figure class=\"highlight json\"><figcaption data-lang=\"JSON\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token property\">\"exports\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token property\">\"./package.json\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./package.json\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token property\">\".\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token property\">\"require\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./index.cjs\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token property\">\"import\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./Source/Cesium.js\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token property\">\"./Source/Widgets/widgets.css\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./Source/Widgets/widgets.css\"</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr></table></figure><p>主要就是添加了  <code>&quot;./Source/Widgets/widgets.css&quot;: &quot;./Source/Widgets/widgets.css&quot; </code>  才能让我们在项目中找到 Cesium 的 css 文件</p>\n<p>修改完这个之后，再次在  <code>main.ts</code>  文件中导入 Cesium，如下</p>\n<figure class=\"highlight ts\"><figcaption data-lang=\"TypeScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * @description 导入 Cesium</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token string\">'cesium/Source/Widgets/widgets.css'</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> Cesium <span class=\"token keyword\">from</span> <span class=\"token string\">'cesium'</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// const Cesium = require('cesium/Source/Cesium')</span></pre></td></tr></table></figure><p>然后启动项目，应该就不会报错啦～～</p>\n<ol start=\"4\">\n<li>编写测试页面</li>\n</ol>\n<p>在  <code>src/views</code>  目录下新建个  <code>map.vue</code>  文件，编写如下</p>\n<figure class=\"highlight ts\"><figcaption data-lang=\"TypeScript\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token operator\">&lt;</span>template<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token operator\">&lt;</span>div id<span class=\"token operator\">=</span><span class=\"token string\">\"cesiumContainer\"</span> <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"map-container\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>template<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token operator\">&lt;</span>script<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token keyword\">import</span> <span class=\"token punctuation\">&#123;</span> defineComponent<span class=\"token punctuation\">,</span> reactive<span class=\"token punctuation\">,</span> toRefs <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">defineComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    name<span class=\"token operator\">:</span> <span class=\"token string\">'Map'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token keyword\">const</span> state <span class=\"token operator\">=</span> <span class=\"token function\">reactive</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token keyword\">const</span> Cesium <span class=\"token operator\">=</span> <span class=\"token function\">inject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'$Cesium'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token function\">onMounted</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token keyword\">let</span> viewer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cesium</span><span class=\"token punctuation\">.</span><span class=\"token function\">Viewer</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cesiumContainer'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>          imageryProvider<span class=\"token operator\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cesium</span><span class=\"token punctuation\">.</span><span class=\"token function\">ArcGisMapServerImageryProvider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>            url<span class=\"token operator\">:</span> <span class=\"token string\">'https://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer'</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span>viewer<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token operator\">...</span><span class=\"token function\">toRefs</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token operator\">&lt;</span>style<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>  #cesiumContainer <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    width<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    height<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">%</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>    padding<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    margin<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>style<span class=\"token operator\">></span></pre></td></tr></table></figure><p>配置好路由之后，启动项目，跳转到指定路由，就能看到一个蓝色的小破球啦，bingo</p>\n<p><img data-src=\"http://image.aayu.today/2022/04/21/62fe3f2f3a751.png\" alt=\"\" /></p>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzI3NjAxNy9hcnRpY2xlL2RldGFpbHMvMTE5Mzc5OTY3\">vue3+cesium+ts 全过程</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wcm9ncmFtbWVyLmluay90aGluay93aHktZGlkLWl0LWZhaWwtdG8taW1wb3J0LWNzcy1vZi1jZXNpdW0taW4tdGhlLXBhY2thZ2luZy10b29sLmh0bWw=\">Why did it fail to import css of Cesium in the packaging tool</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0Nlc2l1bUdTL2Nlc2l1bS9pc3N1ZXMvOTIxMg==\">Can not import widgets.css file not exported from package.json #9212</span></li>\n</ul>\n",
            "tags": [
                "GIS开发笔记",
                "Cesium",
                "学习笔记",
                "Cesium"
            ]
        },
        {
            "id": "https://blog.aayu.today/artificial-intelligence/machine-learning/time-series/20220413/",
            "url": "https://blog.aayu.today/artificial-intelligence/machine-learning/time-series/20220413/",
            "title": "时间序列的线性回归",
            "date_published": "2022-04-13T01:15:13.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>预测可能是机器学习在现实世界中最常见的应用。企业预测产品需求，政府预测经济和人口增长，气象学家预测天气。对未来事物的理解是整个科学、政府和行业 (更不用说我们的个人生活了！) 的迫切需求，这些领域的从业者正越来越多地应用机器学习来满足这一需求。</p>\n<p>时间序列预测是一个有着悠久历史的广泛领域。本课程的重点是现代机器学习方法在时间序列数据上的应用，以产生最准确的预测。本课程的课程灵感来自于过去 Kaggle 预测比赛中获胜的解决方案，但将适用于准确预测是优先考虑的任何时候。</p>\n<p>后续待更...</p>\n",
            "tags": [
                "人工智能",
                "机器学习",
                "时间序列分析",
                "时间序列分析"
            ]
        },
        {
            "id": "https://blog.aayu.today/linux/ubuntu/20220312-3/",
            "url": "https://blog.aayu.today/linux/ubuntu/20220312-3/",
            "title": "Ubuntu挂载WebDAV",
            "date_published": "2022-03-12T11:15:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>WebDAV 是个好东西，尤其是配个自己的 NAS 使用，熟悉以后就再也离不开它啦，这篇博客教小伙伴们如何在 Ubuntu 18.04 下挂载 WebDAV~</p>\n<h2 id=\"本机环境\"><a class=\"anchor\" href=\"#本机环境\">#</a> 本机环境</h2>\n<ul>\n<li>Ubuntu 18.04</li>\n</ul>\n<h2 id=\"操作步骤\"><a class=\"anchor\" href=\"#操作步骤\">#</a> 操作步骤</h2>\n<ol>\n<li>安装 davfs2</li>\n</ol>\n<pre><code>apt-get -y install davfs2\n</code></pre>\n<ol start=\"2\">\n<li>安装完 davfs2 之后执行</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sed</span> -i <span class=\"token string\">'s/# use_locks       1/use_locks       0/g'</span> /etc/davfs2/davfs2.conf</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"你的WebDAV地址 用户名 密码\"</span> <span class=\"token operator\">>></span> /etc/davfs2/secrets <span class=\"token comment\">#保存用户名密码，以后可以直接免密码挂载</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>mount.davfs 你的WebDAV地址 你想要挂载到的目录</pre></td></tr></table></figure><p>即可成功挂载</p>\n<p>注意 1：挂载目录必须提前创建好！<br />\n注意 2：如果你不执行第二句保存用户名密码，那么你以后挂载的时候都会要求输入用户名密码！</p>\n<h2 id=\"开机自动挂载\"><a class=\"anchor\" href=\"#开机自动挂载\">#</a> 开机自动挂载</h2>\n<p>如果想要开机自动挂载，则再执行</p>\n<pre><code>echo &quot;mount.davfs 你的WebDAV地址 你想要挂载到的目录&quot; &gt;&gt; /etc/rc.local\n</code></pre>\n<p>执行完此句之后检查一下  <code>/etc/rc.local</code>  文件，看看是否有  <code>exit 0</code>  这句。如果有的话，要手动把上面命令添加进去的语句放到  <code>exit 0</code>  之前。</p>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tb2UuYmVzdC9saW51eC1tZW1vL21vdW50LXdlYmRhdi5odG1s\">[WebDAV] 如何在各个平台下挂载 WebDAV</span></li>\n</ul>\n",
            "tags": [
                "Linux进阶之路",
                "Ubuntu",
                "Ubuntu"
            ]
        },
        {
            "id": "https://blog.aayu.today/linux/ubuntu/20220312-2/",
            "url": "https://blog.aayu.today/linux/ubuntu/20220312-2/",
            "title": "Ubuntu18.04更换国内源",
            "date_published": "2022-03-12T11:10:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>Ubuntu 本身的源使用的是国外的源，下载速度比较慢，不像 CentOS 一样 yum 安装的时候对镜像站点进项选择，所以选择了更换成国内的源。</p>\n<p>以下内容整合自网络</p>\n<h2 id=\"操作步骤\"><a class=\"anchor\" href=\"#操作步骤\">#</a> 操作步骤</h2>\n<ol>\n<li>备份 /etc/apt/sources.list 文件</li>\n</ol>\n<pre><code>mv /etc/apt/sources.list /etc/apt/sourses.list.backup\n</code></pre>\n<ol start=\"2\">\n<li>新建 /etc/apt/sources.list 文件并添加以下内容</li>\n</ol>\n<pre><code>#163源\ndeb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse\ndeb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse\ndeb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse\ndeb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse\ndeb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse\ndeb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse\ndeb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse\ndeb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse\n</code></pre>\n<ol start=\"3\">\n<li>更改完成之后执行以下命令</li>\n</ol>\n<pre><code># apt update\n# apt upgrade\n</code></pre>\n<h2 id=\"其他的一些apt命令\"><a class=\"anchor\" href=\"#其他的一些apt命令\">#</a> 其他的一些 apt 命令</h2>\n<pre><code>sudo apt-get update  更新源\nsudo apt-get install package 安装包\nsudo apt-get remove package 删除包\nsudo apt-cache search package 搜索软件包\nsudo apt-cache show package  获取包的相关信息，如说明、大小、版本等\nsudo apt-get install package --reinstall  重新安装包\nsudo apt-get -f install  修复安装\nsudo apt-get remove package --purge 删除包，包括配置文件等\nsudo apt-get build-dep package 安装相关的编译环境\nsudo apt-get upgrade 更新已安装的包\nsudo apt-get dist-upgrade 升级系统\nsudo apt-cache depends package 了解使用该包依赖那些包\nsudo apt-cache rdepends package 查看该包被哪些包依赖\nsudo apt-get source package  下载该包的源代码\nsudo apt-get clean &amp;&amp; sudo apt-get autoclean 清理无用的包\nsudo apt-get check 检查是否有损坏的依赖\n</code></pre>\n<h2 id=\"其他几个国内的源\"><a class=\"anchor\" href=\"#其他几个国内的源\">#</a> 其他几个国内的源</h2>\n<h3 id=\"中科大源\"><a class=\"anchor\" href=\"#中科大源\">#</a> 中科大源</h3>\n<pre><code>#中科大源\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\n</code></pre>\n<h3 id=\"阿里云源\"><a class=\"anchor\" href=\"#阿里云源\">#</a> 阿里云源</h3>\n<pre><code>deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse\n</code></pre>\n<h3 id=\"清华源\"><a class=\"anchor\" href=\"#清华源\">#</a> 清华源</h3>\n<pre><code>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse\ndeb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse\n</code></pre>\n",
            "tags": [
                "Linux进阶之路",
                "Ubuntu",
                "Ubuntu"
            ]
        },
        {
            "id": "https://blog.aayu.today/linux/ubuntu/20220312/",
            "url": "https://blog.aayu.today/linux/ubuntu/20220312/",
            "title": "Ubuntu-解决2.5G网卡驱动问题",
            "date_published": "2022-03-12T11:00:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>由于 2.5G 网卡较新，各 linux 发行版的通用驱动已不适用，新装的系统会出现无法上网问题，由于国内网络环境去 Realtek 官网很难下载到驱动文件，故本文提供 github 上的 2.5G Ethernet LINUX driver r8125 for kernel up to 5.6 的版本驱动文件 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL1ZpdG8tVHUvcjgxMjU=\">r8125-9.003.05.tar.bz2</span> 各位可以自行下载，并结合此教程安装。</p>\n<h2 id=\"本机环境\"><a class=\"anchor\" href=\"#本机环境\">#</a> 本机环境</h2>\n<ul>\n<li>Ubuntu 18.04</li>\n</ul>\n<h2 id=\"安装步骤\"><a class=\"anchor\" href=\"#安装步骤\">#</a> 安装步骤</h2>\n<ol>\n<li>准备编译环境</li>\n</ol>\n<pre><code>sudo apt-get install --reinstall linux-headers-$(uname -r) linux-headers-generic build-essential dkms\n</code></pre>\n<ol start=\"2\">\n<li>解压源码到目录 /usr/src</li>\n</ol>\n<pre><code>sudo tar xvf r8125-9.003.05.tar.bz2 -C /usr/src\n</code></pre>\n<ol start=\"3\">\n<li>添加一个 dkms.conf 到 /usr/src/r8125-9.003.05/ 目录</li>\n</ol>\n<pre><code># 先进入目录，方便后续操作\ncd /usr/src/r8125-9.003.05/\n# 创建dkms配置文件\ntouch dkms.conf\n</code></pre>\n<ol start=\"4\">\n<li>编辑 dkms.conf 文件添加如下内容</li>\n</ol>\n<pre><code>PACKAGE_NAME=Realtek_r8125\nPACKAGE_VERSION=9.003.05\n \nDEST_MODULE_LOCATION=/updates/dkms\nBUILT_MODULE_NAME=r8125\nBUILT_MODULE_LOCATION=src/\n \nMAKE=&quot;'make' -C src/ all&quot;\nCLEAN=&quot;'make' -C src/ clean&quot;\nAUTOINSTALL=&quot;yes&quot;\n</code></pre>\n<ol start=\"5\">\n<li>编译安装</li>\n</ol>\n<pre><code>sudo dkms add -m r8125 -v 9.003.05\nsudo dkms build -m r8125 -v 9.003.05\nsudo dkms install -m r8125 -v 9.003.05\nsudo depmod -a\nsudo modprobe r8125\n</code></pre>\n<p>验证安装结果，运行如下命令即可看到 enxxx 的有线网接口</p>\n<pre><code>ifconfig -a\n</code></pre>\n<p>后记：这种方法安装完后，后续如果有内核版本升级，仍需重新编译安装，否则驱动无法运行。执行下方代码重新安装</p>\n<pre><code>sudo dkms remove r8125/9.003.05 --all\n</code></pre>\n<p>但每次出问题都去执行代码太过繁琐，建议在安装目录下（本文是 /usr/src/r8125-9.003.05/）将命令打包成可执行文件 <span class=\"exturl\" data-url=\"aHR0cDovL2ZpeE5ldHdvcmtDYXJkLnNo\">fixNetworkCard.sh</span></p>\n<ol>\n<li>创建文件，赋予可执行权限，并切链接到用户目录～方便使用</li>\n</ol>\n<pre><code># 确保在安装目录\ncd /usr/src/r8125-9.003.05/\n# 创建文件名授权\ntouch fixNetWorkCard.sh\nchmod 777 fixNetWorkCard.sh\n# 回到用户目录创建软连接\ncd ~\nln -s /usr/src/r8125-9.003.05/fixNetWorkCard.sh ./\n</code></pre>\n<ol start=\"2\">\n<li>编辑 <span class=\"exturl\" data-url=\"aHR0cDovL2ZpeE5ldHdvcmtDYXJkLnNo\">fixNetworkCard.sh</span> 文件粘贴以下内容</li>\n</ol>\n<pre><code>dkms remove r8125/9.003.05 --all\ndkms install -m r8125 -v 9.003.05\ndepmod -a\nmodprobe r8125\n</code></pre>\n<ol start=\"3\">\n<li>下次网卡驱动失效时，进行快速修复</li>\n</ol>\n<pre><code>cd ~\nsudo ./fixNetworkCard.sh\n</code></pre>\n<h2 id=\"可能出现的问题\"><a class=\"anchor\" href=\"#可能出现的问题\">#</a> 可能出现的问题</h2>\n<h3 id=\"modprobe-加载模块时-出现权限不允许提醒operation-not-permitted\"><a class=\"anchor\" href=\"#modprobe-加载模块时-出现权限不允许提醒operation-not-permitted\">#</a> modprobe 加载模块时 出现权限不允许提醒；Operation not permitted</h3>\n<p>这是由于 secure boot 的原因。如果 secure boot 是开启状态，内核不能安装自己定制的模块。</p>\n<p>解决方法：我们进入 BIOS 把 secure boot 选项关掉；secure boot 大概的作用时为了保护内核的启动安全。</p>\n<p>linux secure boot 状态查询：mokutil --sb-state<br />\n<img data-src=\"http://image.aayu.today/2022/03/12/3501b5b09bf75.png\" alt=\"\" /></p>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3RodW5kZXJfay9hcnRpY2xlL2RldGFpbHMvMTA2NDk0NTEx\">Ubuntu 安装 Realtek R8125 驱动</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Bvb3JndXlfYW9zL2FydGljbGUvZGV0YWlscy8xMDgyNTA4Mzg=\">解决 linux 2.5G 网卡驱动问题</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veHV5YW93ZW4vcC9saW51eC1zZWN1cmUtYm9vdC1kaXNhYmxlLmh0bWw=\">modprobe 加载模块时 出现权限不允许提醒；Operation not permitted</span></li>\n</ul>\n",
            "tags": [
                "Linux进阶之路",
                "Ubuntu",
                "Ubuntu"
            ]
        },
        {
            "id": "https://blog.aayu.today/basic-subjects/mathematics/advanced-mathematics/20220312/",
            "url": "https://blog.aayu.today/basic-subjects/mathematics/advanced-mathematics/20220312/",
            "title": "高等数学-常用公式",
            "date_published": "2022-03-11T16:00:00.000Z",
            "content_html": "<p><img data-src=\"http://image.aayu.today/2022/03/05/e8f45bd5ba680.jpg\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/03/12/f4c3e2d6045a0.jpg\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/03/12/186c8c62e410f.jpg\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/03/12/60421e57c4f60.jpg\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/03/12/aa7d9101fe782.jpg\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/03/12/52bbf53b0c6ea.jpg\" alt=\"\" /></p>\n",
            "tags": [
                "基础学科",
                "数学",
                "高等数学",
                "高等数学"
            ]
        },
        {
            "id": "https://blog.aayu.today/leisure/mood/20220311/",
            "url": "https://blog.aayu.today/leisure/mood/20220311/",
            "title": "心情-放风筝",
            "date_published": "2022-03-10T16:00:00.000Z",
            "content_html": "<h1 id=\"心情-放风筝\"><a class=\"anchor\" href=\"#心情-放风筝\">#</a> 心情 - 放风筝</h1>\n<p>依稀记得小时候放风筝时的开心模样，没想到时隔今日还能再放起来，好开心哈哈Ｏ(≧▽≦)Ｏ</p>\n<p><img data-src=\"http://image.aayu.today/2022/03/12/dfeeff448ff49.jpg\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/03/12/a5e6b7de7ea05.jpg\" alt=\"\" /></p>\n",
            "tags": [
                "清风明月",
                "心情",
                "心情"
            ]
        },
        {
            "id": "https://blog.aayu.today/nas/synology/20220114/",
            "url": "https://blog.aayu.today/nas/synology/20220114/",
            "title": "兰空图床（Lsky）搭配PicGo客户端进行图片快速上传",
            "date_published": "2022-01-13T16:00:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>前几天成功的实现了通过黑群晖 NAS 搭建自己的图床，在体验了几天后，发现兰空图床是真的好好用呀～界面美观、操作简单，也没有那些让人困惑的操作或功能～～</p>\n<p>而我之前的博客所用的图床最开始是白嫖的 GitHub，后面又用了腾讯云 COS 图床，哎总的来说，体验都不是很好，GitHub 图床就算是配置了 CDN 也会有访问缓慢甚至访问不了的情况，而腾讯云 COS 图床又是收费的，虽然费用也不贵，但总是不那么舒服。终于，在接触了 NAS 后，这个问题就完美的解决了，而且数据存储在自己的手上，也是那么的让人安心～～</p>\n<p>图床已经配置好啦，那么就要配置另一款上传图片的利器了，那就是  <code>PicGo</code></p>\n<p>PicGo 是一个可以将图片方便且快速的上传至图床的一个小工具。而我平常在写博客的过程中，会时不时的截取一些图片，截取图片我们可以通过 QQ 自带的  <code>Ctrl + Alt + A</code>  来截图，截完以后图片就被保存到剪切板了，接下来，只需要配置好 PicGo，通过 PicGo 上传图片的快捷键，就可以直接将剪切板里的图片上传到自己的图床，并且返回一个 Markdown 格式的图片链接到粘贴板，直接粘贴到博客里，实现图片的在线浏览真的是不要太方便～～</p>\n<p>接下来的这个教程就是教小伙伴们如何配置 PicGo，来实现快速上传图片到我们的兰空图床，教程也是很简单的啦～～</p>\n<h2 id=\"教程\"><a class=\"anchor\" href=\"#教程\">#</a> 教程</h2>\n<h3 id=\"安装-picgo-的-lskypro-扩展插件\"><a class=\"anchor\" href=\"#安装-picgo-的-lskypro-扩展插件\">#</a> 安装 PicGo 的 lskypro 扩展插件</h3>\n<p>PicGo 可以直接在网上找安装包安装，安装好以后，打开 PciGo 客户端，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/15/24be88fb5965e.png\" alt=\"\" /></p>\n<p>点击插件设置，然后在里面搜索 lskypro，搜索到插件后点击安装即可安装 lskypro 扩展插件，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/15/3fad8291ee96f.png\" alt=\"\" /></p>\n<h3 id=\"配置-lskypro\"><a class=\"anchor\" href=\"#配置-lskypro\">#</a> 配置 lskypro</h3>\n<p>首先打开兰空图床的后台管理界面，在  <code>系统管理 -&gt; 系统设置 -&gt; 其他配置</code>  里面，打开  <code>开启 API</code>  的开关，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/15/a3da4ad7162b4.png\" alt=\"\" /></p>\n<p>然后可以在左侧菜单栏中找到  <code>接口</code>  设置，可以在里面详细查看接口的相关说明，主要需要关注的是图片上传的  <code>URL</code>  参数，如下图所示</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/15/f228494efa5ba.png\" alt=\"\" /></p>\n<p>然后点击左侧  <code>设置</code> ，在里面找到自己的上传 Token，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/15/fc5ab2a3d2734.png\" alt=\"\" /></p>\n<p>接下来就可以在 PciGo 里面配置 lskypro 插件了，如下图，将刚刚找到的图片上传 URL 和 Token 设置进去</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/15/8154e0af5e9a1.png\" alt=\"\" /></p>\n<p>点击确定，点击设置为默认图床，设置完成～～</p>\n<h3 id=\"其他设置\"><a class=\"anchor\" href=\"#其他设置\">#</a> 其他设置</h3>\n<p>以上设置好以后，就可以在 PciGo 的上传区上传一张图片测试一下啦，下面在推荐一下其他的设置，首先 PicGo 的默认上传快捷键是  <code>Ctrl + Shift + P</code> ，个人感觉不是很方便，所以我将上传快捷键改成了  <code>Ctrl + Shift + Z</code> ，这样我可以首先用 QQ 自带的截图工具  <code>Ctrl + Alt + A</code> ，截图自己想要的图片后，再直接单手按  <code>Ctrl + Shift + Z</code>  就可以直接把刚刚截的图片上传到自己的图床了，简直不要太方便～</p>\n<p>修改快捷键可以在 PicGo 的设置中设置，同时我还会开启  <code>开机自启</code>  和  <code>时间戳重命名</code>  这两个设置，时间戳重命名可以直接将刚刚用 QQ 截取的乱七八糟文件名改成当前的时间，看起来就舒服很多啦，设置如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/15/2a7bd851eef7f.png\" alt=\"\" /></p>\n<p>至此，我们的兰空图床（Lsky）搭配 PicGo 客户端进行图片快速上传就设置好啦，接下来愉快的玩耍吧～～</p>\n",
            "tags": [
                "我的NAS捣鼓笔记",
                "群晖",
                "NAS",
                "Synology",
                "Lsky",
                "PicGo"
            ]
        },
        {
            "id": "https://blog.aayu.today/nas/synology/20220111/",
            "url": "https://blog.aayu.today/nas/synology/20220111/",
            "title": "黑群晖NAS搭建兰空图床（Lsky）",
            "date_published": "2022-01-10T16:00:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>真的是空了好长一段时间才来更新自己的博客了 hh。前段时间自己入了 NAS 的坑，看了好多关于 NAS 的博客文章和教程，自己也花了不到 800 搭建了自己的第一台 NAS 哈哈，又在多多上花了 800 多买了两块 4T 紫盘，终于开启了自己的 NAS 捣鼓之旅～～</p>\n<p>补充一下哈哈，NAS 可以当作自己的私有存储空间，类似于百度网盘一样，但区别是百度网盘是第三方服务，存储空间都是人家的，而我们的 NAS 也就是一台小型电脑，但存储空间可以自己掌握，比如说我买了两块 4T 的机械硬盘，就相当于我有 8T 的存储空间，同时，又因为 NAS 类似于一个小型电脑，我们可以在上面部署自己的服务，如把自己的个人博客搭建在上面，把自己的图床放在上面等等～～</p>\n<p>NAS 最吸引我的一点就是自己的数据自己掌握，自己的数据都放在自己的机械硬盘里，并且将硬盘组成一个 RAID 阵列，这个阵列可以把它当成一个数据保护措施，比如两块硬盘可以组一个 RAID1 阵列，当有一块硬盘由于未知原因损坏的时候，只要把坏的硬盘取下来，换上一个好的硬盘，数据就会自动进行恢复，最大程度上避免了数据丢失。与 RAID1 阵列类似的还有 RAID5 和 RAID10 阵列，它们的区别就是硬盘的可用空间不同<sub>感兴趣的可以自己去查阅相关资料呀</sub>～</p>\n<p>哈哈，现在自己在 NAS 的收获上真的很多，目前已经在 NAS 上完成了个人导航页、个人网盘、以及相册的部署～～</p>\n<p>后续等这篇博客的图床在 NAS 搭建好以后，就可以把自己的个人博客也迁移到 NAS 上了～～</p>\n<p>哦哦还有一个忘了说，NAS 还有一个很棒的功能就是自动备份手机的照片，当配置好以后，我们换手机就再也不用担心照片的问题了，也不用第三方的手机照片备份服务了，真的是又贵空间又小～</p>\n<p>欢迎大家访问我的个人导航页～～<span class=\"exturl\" data-url=\"aHR0cHM6Ly9hYXl1LnRvZGF5\">阿宇的导航页</span></p>\n<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<ul>\n<li>处理器：J3455-itx</li>\n<li>群晖系统：DSM 6.2.3-25426 Upload 3</li>\n<li>产品型号：DS3617xs</li>\n<li>存储空间：两块 4T 紫盘组 RAID1 阵列</li>\n</ul>\n<h2 id=\"安装教程\"><a class=\"anchor\" href=\"#安装教程\">#</a> 安装教程</h2>\n<h3 id=\"搭建宝塔面板\"><a class=\"anchor\" href=\"#搭建宝塔面板\">#</a> 搭建宝塔面板</h3>\n<p>首先在群晖的 docker 应用里面搜索 baota，选择  <code>pch18/baota</code>  这个镜像，双击下载最新的 latest 版本的镜像</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/e7789a2be6329.png\" alt=\"\" /></p>\n<p>下载好以后可以在镜像列表中看到，如下图，可以看到该容器的大小是真不小啊，占了 5GB 大小的空间</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/3d21f3bf28d50.png\" alt=\"\" /></p>\n<p>选中该镜像，点击上方的启动，点击高级配置，设置存储空间映射如下图所示</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/6920258f5c87b.png\" alt=\"\" /></p>\n<p>端口设置如下图所示</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/2715710220830.png\" alt=\"\" /></p>\n<p>设置完成后，点击确定，等待稍微一段时间后，弹出命令创建失败，这时候别慌。我们可以用 ssh 连接到 NAS 里面，输入  <code>docker ps</code> ，发现宝塔容器确实没有起来，再次敲击  <code>docker ps -a</code>  可以查看所以运行过的容器，发现宝塔容器的状态是  <code>Created</code> ，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/85c42971f05d3.png\" alt=\"\" /></p>\n<p>所以只需要用  <code>docker start 宝塔容器ID</code> ，启动容器即可。容器启动以后，再次用  <code>docker ps</code>  命令，就可以看到已经成功启动的宝塔容器了～～</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/3e1abcce3b028.png\" alt=\"\" /></p>\n<p>启动完成以后，在浏览器中输入  <code>ip:18888</code> ，可以看到成功进入宝塔的登陆界面啦，但用户名和密码我们需要通过重置才能获取到</p>\n<p>在 NAS 后台管理界面，打开 docker 应用，可以看到我们的宝塔容器也确实启动成功了</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/2f0547340adf7.png\" alt=\"\" /></p>\n<p>我们还是用 ssh 连接 NAS 系统，然后用  <code>docker exec -it 宝塔容器ID /bin/bash</code>  进入容器内部系统，然后输入  <code>bt</code>  即可对用户名和密码进行重置，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/5c0a8442abf54.png\" alt=\"\" /></p>\n<p>重置完用户名和密码后，在容器内部按  <code>Ctrl + P + Q</code>  即可在容器继续运行的情况下安全退出容器～</p>\n<p>用新用户名和密码，即可成功登录宝塔面板啦～</p>\n<h3 id=\"安装兰空图床\"><a class=\"anchor\" href=\"#安装兰空图床\">#</a> 安装兰空图床</h3>\n<p>首先进入主页面，点击 PHP-7.3，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/1ebfe72982cc2.png\" alt=\"\" /></p>\n<p>然后在安装扩展这里点击 fileinfo 扩展安装（因为我已经装过了，所以这里显示的是卸载）</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/ea3ab0f0c4f47.png\" alt=\"\" /></p>\n<p>安装完成以后，点击网站，开始新建站点，配置如下图，注意在 IP 后面配置一个可以访问的端口，默认的 80 端口应该是使用不了的</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/0af4c3de78a55.png\" alt=\"\" /></p>\n<p>然后在兰空图床的 GitHub 官网上下载最新的发行包，并上传到站点的根目录，然后解压，解压完成之后记得把解压之后的文件放在站点的根目录，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/b4b042cd16722.png\" alt=\"\" /></p>\n<p>接下来点击站点名称，可以进行网站设置，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/6e4d58cbf32b4.png\" alt=\"\" /></p>\n<p>在网站目录下，设置运行目录为  <code>/public</code> ，点击保存，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/4553770b23267.png\" alt=\"\" /></p>\n<p>根据兰空图床<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cua2FuY2xvdWQuY24vd2lzcHgvbHNreS1wcm8vODgwMDQ0\">官网教程</span>，nginx 需要设置伪静态，代码如下</p>\n<pre><code>location / &#123;\n    if (!-e $request_filename) &#123;\n    \trewrite ^(.*)$ /index.php?s=$1 last; break;\n    &#125;\n&#125;\n</code></pre>\n<p>设置如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/15a3203b8d92d.png\" alt=\"\" /></p>\n<p>记得点击保存。这样我们的兰空图床的站点就配置好啦～～</p>\n<h3 id=\"初始化访问\"><a class=\"anchor\" href=\"#初始化访问\">#</a> 初始化访问</h3>\n<p>在浏览器输入  <code>ip地址:10003</code> ，后，博主发现了一个问题，访问这个端口失败 emmmm</p>\n<p>在博主仔细检查了后发现，我们在最开始设置 docker 端口映射时，忘记映射我们这个  <code>10003</code>  端口了，诶呀真是失策</p>\n<p>所以接下来的操作就是，在 NAS 后台管理界面，进行 docker 应用，先把宝塔容器暂停运行，然后选择宝塔容器，点击上面的编辑，在端口设置里面添加  <code>10003</code>  的端口映射，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/3be66807ee889.png\" alt=\"\" /></p>\n<p>设置完之后，再把宝塔容器重新恢复运行，注意哦注意哦，这里我们重新刷新宝塔的访问界面，可以在首页发现 Nginx 服务是停止运行的，这就需要我们手动启动这个服务，这里是一个要注意的小地方</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/fb5479c4d1edc.png\" alt=\"\" /></p>\n<p>当把以上这些都完成以后，再次在浏览器输入  <code>ip地址:10003</code> ，终于出现了让人开心的界面，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/44d9065f8e998.png\" alt=\"\" /></p>\n<p>我们点击下一步，这里的数据库名，用户名和密码可以在宝塔界面的数据库那里查看，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/c48e9e9c3998a.png\" alt=\"\" /></p>\n<p>配置如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/e387b7616a750.png\" alt=\"\" /></p>\n<p>然后点击下一步，在接下来的界面配置一下管理员的邮箱和密码，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/707ac27baa7af.png\" alt=\"\" /></p>\n<p>这样我们的图床就配置好啦，开心ヾ (≧▽≦*) o</p>\n<p>我们可以在左侧点击登陆，进入图床后台进行详细查看，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/12/e62e686015c82.png\" alt=\"\" /></p>\n<p>输入刚才设置的用户名和密码，就可以进入到图床后台了。在图床后台可以设置上传图片的大小等等，接下来就开始愉快的使用图床吧～～</p>\n<p>后续我就会把我的个人博客也都迁移到我的 NAS 里面，啦啦～～</p>\n<h2 id=\"参考链接\"><a class=\"anchor\" href=\"#参考链接\">#</a> 参考链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cua2FuY2xvdWQuY24vd2lzcHgvbHNreS1wcm8vODgwMDQ0\">兰空图床官网教程</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuZGFuaWFvLm9yZy8xMDIyOS5odG1s\">宝塔面板安装 lsky-pro（ 兰空图床） – 一款安装简单、功能强大的图床程序</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9wb3N0LnNtemRtLmNvbS9wL2FscHp4enEwLyNjb21tZW50cw==\">NAS 篇：群晖 Docker 直接装宝塔面板一键部署建站系统</span></li>\n</ul>\n",
            "tags": [
                "我的NAS捣鼓笔记",
                "群晖",
                "NAS",
                "Synology",
                "Lsky"
            ]
        },
        {
            "id": "https://blog.aayu.today/hardware/iot/20211124/",
            "url": "https://blog.aayu.today/hardware/iot/20211124/",
            "title": "使用Air724UG模块拍摄照片并上传至云服务器",
            "date_published": "2021-11-23T16:00:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>最近在做物联网的项目，有一个需求是要每隔一段时间要拍摄一张现场的图片并上传至云服务器保存。在查阅了很多资料后，发现这方面的资料是真的匮乏。同时，tb 上的摄像头产品也太高度集成了，很难进行二次开发。一次机缘巧合下，在逛 tb 的时候偶然发现一款产品，就是如下图所示 Air724UG 模块，自带 4G 通信模块和摄像头接口，而且成本也比较便宜，带通信卡和摄像头总价格不超过 80，简直就是完美符合我需求的天选产品。同时该系列产品的官方网站上也给出了很多代码 demo，非常有利于初学者的学习。最终，在经历了几天的学习后，终于成功把这个需求实现了，开心ヾ (・ω・`) o，于是在此记录下来，希望能帮助到其他有需要的小伙伴们～</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/2223ff21b72de.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/ed1fd4c843f37.png\" alt=\"\" /></p>\n<h2 id=\"基础知识\"><a class=\"anchor\" href=\"#基础知识\">#</a> 基础知识</h2>\n<p>如果买了这个模块，首先把卖家写的五篇开发文档看一下，如下</p>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWFuZ2Zlbmd3dS9wLzE1MTIyMzAzLmh0bWw=\">1-Air724UG (4G 全网通 GPRS) 开发 - 硬件使用说明</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWFuZ2Zlbmd3dS9wLzE1MTI1NDA2Lmh0bWw=\">2-Air724UG (4G 全网通 GPRS) 开发 - 下载 AT 指令固件</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWFuZ2Zlbmd3dS9wLzE1MTYzODYzLmh0bWw=\">200-Air724UG (4G 全网通 GPRS) 开发 - 下载和运行第一个 lua 程序</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWFuZ2Zlbmd3dS9wLzE1MTYzOTg2Lmh0bWw=\">201-Air724UG 模块 (4G 全网通 GPRS 开发)- 模块测试 - 测试 SD 卡和扬声器 (喇叭) 播放功能</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veWFuZ2Zlbmd3dS9wLzE1MTY0NDUzLmh0bWw=\">202-Air724UG 模块 (4G 全网通 GPRS 开发)- 模块测试 - 摄像头扫码，LCD 显示摄像头图像</span></li>\n</ul>\n<p>最重要的是最后一个文档，因为我们后面要修改这里面的代码。</p>\n<p>看完文档后，应该就会对 Air724UG 模块有了大致的了解，同时我们也会发觉二次开发是基于 Lua 语言的。有小伙伴可能就会问，没学过 Lua 语言肿么办</p>\n<p>莫慌，因为合宙官方给出了很多案例的示例代码，包括上面第五个文档里面用的摄像头案例的代码。我们可以打开代码看一下，官方的代码规范写的很好，每一句代码几乎都有注释，这就非常有利于我们初学者的学习～</p>\n<p>博主也是在大致浏览了下代码后，尝试性的将 socket 的示例代码和 camera 的示例代码融合起来，成功的解决了这个需求，下面就具体看看修改后的代码吧～</p>\n<h2 id=\"编写-tcp-客户端代码\"><a class=\"anchor\" href=\"#编写-tcp-客户端代码\">#</a> 编写 TCP 客户端代码</h2>\n<p>目前拍摄的需求已经通过默认的 camera 示例代码实现了，下面要实现的就是如何把照片上传到云端。搞过开发的同学应该都大致了解 socket 这个东西，我们各种网络通信的基础就是 socket，我们用 socket 也可以很快搭建一个 tcp 服务器，这样就相当于我们的摄像头模块是 tcp 客户端，部署了代码的云服务器是 tcp 服务器端，两端连通以后，就可以实现将照片传输到云端啦～</p>\n<p>下面先看一下 TCP 客户端具体代码</p>\n<p>主要用到的就是官方  <code>demo\\socket\\async\\asyncSocket</code>  的案例和  <code>demo\\camera</code>  这两个案例，我们按照 socket 案例的 main 文件修改 camera 案例的 main 文件，修改后如下</p>\n<figure class=\"highlight lua\"><figcaption data-lang=\"lua\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 必须在这个位置定义 PROJECT 和 VERSION 变量</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">--PROJECT：ascii string 类型，可以随便定义，只要不使用，就行</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">--VERSION：ascii string 类型，如果使用 Luat 物联云平台固件升级的功能，必须按照 \"X.X.X\" 定义，X 表示 1 位数字；否则可随便定义</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>PROJECT <span class=\"token operator\">=</span> <span class=\"token string\">\"CAMERA\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>VERSION <span class=\"token operator\">=</span> <span class=\"token string\">\"2.0.0\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">-- 加载日志功能模块，并且设置日志输出等级</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">-- 如果关闭调用 log 模块接口输出的日志，等级设置为 log.LOG_SILENT 即可</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>require <span class=\"token string\">\"log\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>LOG_LEVEL <span class=\"token operator\">=</span> log<span class=\"token punctuation\">.</span>LOGLEVEL_TRACE</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">--[[</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>如果使用 UART 输出日志，打开这行注释的代码 \"--log.openTrace (true,1,115200)\" 即可，根据自己的需求修改此接口的参数</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>如果要彻底关闭脚本中的输出日志（包括调用 log 模块接口和 Lua 标准 print 接口输出的日志），执行 log.openTrace (false, 第二个参数跟调用 openTrace 接口打开日志的第二个参数相同)，例如：</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>1、没有调用过 sys.opntrace 配置日志输出端口或者最后一次是调用 log.openTrace (true,nil,921600) 配置日志输出端口，此时要关闭输出日志，直接调用 log.openTrace (false) 即可</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>2、最后一次是调用 log.openTrace (true,1,115200) 配置日志输出端口，此时要关闭输出日志，直接调用 log.openTrace (false,1) 即可</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>]]</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">--log.openTrace(true,1,115200)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>require <span class=\"token string\">\"sys\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>require <span class=\"token string\">\"utils\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>require <span class=\"token string\">\"patch\"</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>require <span class=\"token string\">\"pins\"</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>require <span class=\"token string\">\"net\"</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">-- 每 1 分钟查询一次 GSM 信号强度</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">-- 每 1 分钟查询一次基站信息</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\">-- net.startQueryAll(60000, 60000)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">--8 秒后查询第一次 csq</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>net<span class=\"token punctuation\">.</span><span class=\"token function\">startQueryAll</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">60</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">-- 此处关闭 RNDIS 网卡功能</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token comment\">-- 否则，模块通过 USB 连接电脑后，会在电脑的网络适配器中枚举一个 RNDIS 网卡，电脑默认使用此网卡上网，导致模块使用的 sim 卡流量流失</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">-- 如果项目中需要打开此功能，把 ril.request (\"AT+RNDISCALL=0,1\") 修改为 ril.request (\"AT+RNDISCALL=1,1\") 即可</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">-- 注意：core 固件：V0030 以及之后的版本、V3028 以及之后的版本，才以稳定地支持此功能</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>ril<span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"AT+RNDISCALL=0,1\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">-- 加载控制台调试功能模块（此处代码配置的是 uart1，波特率 115200）</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\">-- 此功能模块不是必须的，根据项目需求决定是否加载</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\">-- 使用时注意：控制台使用的 uart 不要和其他功能使用的 uart 冲突</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">-- 使用说明参考 demo/console 下的《console 功能使用说明.docx》</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\">--require \"console\"</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token comment\">--console.setup(1, 115200)</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token comment\">-- 加载硬件看门狗功能模块</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\">-- 根据自己的硬件配置决定：1、是否加载此功能模块；2、配置 Luat 模块复位单片机引脚和互相喂狗引脚</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token comment\">-- 合宙官方出售的 Air201 开发板上有硬件看门狗，所以使用官方 Air201 开发板时，必须加载此功能模块</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token comment\">--[[</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>require \"wdt\"</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>wdt.setup(pio.P0_30, pio.P0_31)</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>]]</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token comment\">-- 加载网络指示灯和 LTE 指示灯功能模块</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token comment\">-- 根据自己的项目需求和硬件配置决定：1、是否加载此功能模块；2、配置指示灯引脚</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token comment\">-- 合宙官方出售的 Air720U 开发板上的网络指示灯引脚为 pio.P0_1，LTE 指示灯引脚为 pio.P0_4</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>require <span class=\"token string\">\"netLed\"</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>pmd<span class=\"token punctuation\">.</span><span class=\"token function\">ldoset</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>pmd<span class=\"token punctuation\">.</span>LDO_VLCD<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>netLed<span class=\"token punctuation\">.</span><span class=\"token function\">setup</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">true</span><span class=\"token punctuation\">,</span>pio<span class=\"token punctuation\">.</span>P0_1<span class=\"token punctuation\">,</span>pio<span class=\"token punctuation\">.</span>P0_4<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token comment\">-- 网络指示灯功能模块中，默认配置了各种工作状态下指示灯的闪烁规律，参考 netLed.lua 中 ledBlinkTime 配置的默认值</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token comment\">-- 如果默认值满足不了需求，此处调用 netLed.updateBlinkTime 去配置闪烁时长</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token comment\">-- 加载错误日志管理功能模块【强烈建议打开此功能】</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token comment\">-- 如下 2 行代码，只是简单的演示如何使用 errDump 功能，详情参考 errDump 的 api</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>require <span class=\"token string\">\"errDump\"</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>errDump<span class=\"token punctuation\">.</span><span class=\"token function\">request</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"udp://ota.airm2m.com:9072\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token comment\">-- 加载远程升级功能模块【强烈建议打开此功能】</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token comment\">-- 如下 3 行代码，只是简单的演示如何使用 update 功能，详情参考 update 的 api 以及 demo/update</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token comment\">--PRODUCT_KEY = \"v32xEAKsGTIEQxtqgwCldp5aPlcnPs3K\"</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre><span class=\"token comment\">--require \"update\"</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token comment\">--update.request()</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>require<span class=\"token string\">\"color_lcd_spi_st7735\"</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token comment\">--require\"color_lcd_spi_gc9106l\"</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>require<span class=\"token string\">\"testCamera\"</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token comment\">-- 系统工具</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>require <span class=\"token string\">\"misc\"</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>require <span class=\"token string\">\"testSocket\"</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>require <span class=\"token string\">\"ntp\"</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>ntp<span class=\"token punctuation\">.</span><span class=\"token function\">timeSync</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"----------------> AutoTimeSync is Done ! &lt;----------------\"</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre></pre></td></tr><tr><td data-num=\"83\"></td><td><pre><span class=\"token comment\">-- 启动系统框架</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>sys<span class=\"token punctuation\">.</span><span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>sys<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>然后在 camera 案例下添加一个  <code>testSocket.lua</code>  文件，编写代码如下</p>\n<figure class=\"highlight lua\"><figcaption data-lang=\"lua\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">--- testSocket</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-- @module asyncSocket</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">-- @author AIRM2M</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- @license MIT</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">-- @copyright openLuat.com</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">-- @release 2018.10.27</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>require <span class=\"token string\">\"socket\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">...</span><span class=\"token punctuation\">,</span> package<span class=\"token punctuation\">.</span>seeall<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">-- 此处的 IP 和端口请填上你自己的 socket 服务器和端口</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">-- local ip, port, c = \"180.97.80.55\", \"12415\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">local</span> ip<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">,</span> c <span class=\"token operator\">=</span> <span class=\"token string\">\"xxx.xxx.xxx.xxx\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"9999\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">-- 异步接口演示代码</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">local</span> asyncClient</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>sys<span class=\"token punctuation\">.</span><span class=\"token function\">taskInit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token keyword\">true</span> <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token keyword\">not</span> socket<span class=\"token punctuation\">.</span><span class=\"token function\">isReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> sys<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        asyncClient <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span><span class=\"token function\">tcp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token keyword\">not</span> asyncClient<span class=\"token punctuation\">:</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>ip<span class=\"token punctuation\">,</span> port<span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> sys<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token keyword\">while</span> asyncClient<span class=\"token punctuation\">:</span><span class=\"token function\">asyncSelect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        asyncClient<span class=\"token punctuation\">:</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">-- 测试代码，用于发送消息给 socket</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>sys<span class=\"token punctuation\">.</span><span class=\"token function\">taskInit</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token keyword\">not</span> socket<span class=\"token punctuation\">.</span><span class=\"token function\">isReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> sys<span class=\"token punctuation\">.</span><span class=\"token function\">wait</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token keyword\">local</span> fileHandle <span class=\"token operator\">=</span> io<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/testCamera.jpg\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"rb\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> fileHandle <span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            log<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testALiYun.otaCb1 open file error\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------------start send photo\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        asyncClient<span class=\"token punctuation\">:</span><span class=\"token function\">asyncSend</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token keyword\">while</span> <span class=\"token keyword\">true</span> <span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token keyword\">local</span> data <span class=\"token operator\">=</span> fileHandle<span class=\"token punctuation\">:</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span>size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> data <span class=\"token keyword\">then</span> <span class=\"token keyword\">break</span> <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            asyncClient<span class=\"token punctuation\">:</span><span class=\"token function\">asyncSend</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------------end send photo\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        fileHandle<span class=\"token punctuation\">:</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr></table></figure><p>注意把上面的 ip 地址换成你后面部署 tcp 服务器端的云服务器的 ip 地址</p>\n<p>这个文件编写完成以后，就可以在  <code>testCamera.lua</code>  文件里面调用这个函数了， <code>testCamera.lua</code>  文件具体编辑如下，其中中间省略了一些没有修改的代码</p>\n<figure class=\"highlight lua\"><figcaption data-lang=\"lua\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">--- 模块功能：camera 功能测试.</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">-- @author openLuat</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">-- @module fs.testFs</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- @license MIT</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">-- @copyright openLuat</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">-- @release 2018.03.27</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">module</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">...</span><span class=\"token punctuation\">,</span>package<span class=\"token punctuation\">.</span>seeall<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>require<span class=\"token string\">\"pm\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>require<span class=\"token string\">\"scanCode\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>require<span class=\"token string\">\"utils\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>require<span class=\"token string\">\"common\"</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>require<span class=\"token string\">\"testUartSentFile\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>require<span class=\"token string\">\"testSocket\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">local</span> WIDTH<span class=\"token punctuation\">,</span>HEIGHT <span class=\"token operator\">=</span> disp<span class=\"token punctuation\">.</span><span class=\"token function\">getlcdinfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">local</span> DEFAULT_WIDTH<span class=\"token punctuation\">,</span>DEFAULT_HEIGHT <span class=\"token operator\">=</span> <span class=\"token number\">320</span><span class=\"token punctuation\">,</span><span class=\"token number\">240</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">-- 扫码结果回调函数</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">-- @bool result，true 或者 false，true 表示扫码成功，false 表示超时失败</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">-- @string [opt=nil] codeType，result 为 true 时，表示扫码类型；result 为 false 时，为 nil；支持 QR-Code 和 CODE-128 两种类型</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">-- @string [opt=nil] codeStr，result 为 true 时，表示扫码结果的字符串；result 为 false 时，为 nil</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">local</span> <span class=\"token keyword\">function</span> <span class=\"token function\">scanCodeCb</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">,</span>codeType<span class=\"token punctuation\">,</span>codeStr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token keyword\">local</span> bf302A_sdr <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t<span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token keyword\">local</span> gc6153 <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t<span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">local</span> gc0310_ddr <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t<span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">local</span> gc0310_ddr_big <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t<span class=\"token punctuation\">....</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token keyword\">local</span> gc0310_sdr <span class=\"token operator\">=</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t<span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">scan</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token comment\">-- 拍照并显示</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">takePhotoAndDisplay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token comment\">-- 拍照并通过 uart1 发送出去</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">takePhotoAndSendToUart</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>    <span class=\"token punctuation\">...</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token comment\">-- 拍照并通过 socket 发送出去</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token keyword\">function</span> <span class=\"token function\">takePhotoAndSendToSocket</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token comment\">-- 唤醒系统</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    pm<span class=\"token punctuation\">.</span><span class=\"token function\">wake</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testTakePhoto\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>    <span class=\"token comment\">-- 打开摄像头</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    disp<span class=\"token punctuation\">.</span><span class=\"token function\">cameraopen</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>    <span class=\"token comment\">--disp.cameraopen (1,0,0,0)  -- 因目前 core 中还有问题没解决，所以不能关闭隔行隔列</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>    <span class=\"token comment\">-- 打开摄像头预览</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token comment\">-- 如果有 LCD，使用 LCD 的宽和高</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>    <span class=\"token comment\">-- 如果无 LCD，宽度设置为 240 像素，高度设置为 320 像素，240*320 是 Air268F 支持的最大分辨率</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    disp<span class=\"token punctuation\">.</span><span class=\"token function\">camerapreview</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>DEFAULT_WIDTH<span class=\"token punctuation\">,</span>DEFAULT_HEIGHT<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>    <span class=\"token comment\">-- 设置照片的宽和高像素并且开始拍照</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>    <span class=\"token comment\">-- 此处设置的宽和高和预览时的保持一致</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    disp<span class=\"token punctuation\">.</span><span class=\"token function\">cameracapture</span><span class=\"token punctuation\">(</span>DEFAULT_WIDTH<span class=\"token punctuation\">,</span>DEFAULT_HEIGHT<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>    <span class=\"token comment\">-- 设置照片保存路径</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    disp<span class=\"token punctuation\">.</span><span class=\"token function\">camerasavephoto</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/testCamera.jpg\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>    log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-----------------------------------------------testCamera.takePhotoAndSendToSocket fileSize\"</span><span class=\"token punctuation\">,</span>io<span class=\"token punctuation\">.</span><span class=\"token function\">fileSize</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/testCamera.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>    <span class=\"token comment\">-- 关闭摄像头预览</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>    disp<span class=\"token punctuation\">.</span><span class=\"token function\">camerapreviewclose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    <span class=\"token comment\">-- 关闭摄像头</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>    disp<span class=\"token punctuation\">.</span><span class=\"token function\">cameraclose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    <span class=\"token comment\">-- 允许系统休眠</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    pm<span class=\"token punctuation\">.</span><span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"testTakePhoto\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    testSocket<span class=\"token punctuation\">.</span><span class=\"token function\">sendFile</span><span class=\"token punctuation\">(</span>io<span class=\"token punctuation\">.</span><span class=\"token function\">fileSize</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/testCamera.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    sys<span class=\"token punctuation\">.</span><span class=\"token function\">timerStart</span><span class=\"token punctuation\">(</span>takePhotoAndSendToSocket<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token operator\">*</span><span class=\"token number\">60</span><span class=\"token operator\">*</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre><span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre></pre></td></tr><tr><td data-num=\"97\"></td><td><pre><span class=\"token comment\">-- sys.timerStart(takePhotoAndDisplay,1000)</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre><span class=\"token comment\">-- sys.timerStart(takePhotoAndSendToUart,1000)</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>sys<span class=\"token punctuation\">.</span><span class=\"token function\">timerStart</span><span class=\"token punctuation\">(</span>takePhotoAndSendToSocket<span class=\"token punctuation\">,</span><span class=\"token number\">10000</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre><span class=\"token comment\">-- sys.timerStart(scan,1000)</span></pre></td></tr></table></figure><p>修改完这三个文件之后，我们就可以把这个案例烧录到 Air724UG 模块上了，这样我们 TCP 客户端就弄好了，下面来看下 TCP 服务器端的代码吧～</p>\n<h2 id=\"编写-tcp-服务端代码\"><a class=\"anchor\" href=\"#编写-tcp-服务端代码\">#</a> 编写 TCP 服务端代码</h2>\n<p>这里 socket 的编程可以用 python 写，也可以用 go 或其他语言写，因为我最近在学 go，所以我就用 go 来编写 tcp 服务器端的代码啦，具体  <code>main.go</code>  文件编写如下</p>\n<figure class=\"highlight go\"><figcaption data-lang=\"go\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">package</span> main</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token string\">\"bytes\"</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token string\">\"encoding/binary\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token string\">\"encoding/hex\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t<span class=\"token string\">\"fmt\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t<span class=\"token string\">\"log\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token string\">\"net\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token string\">\"os\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t<span class=\"token string\">\"strconv\"</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token string\">\"time\"</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">GetDetailTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\tnow <span class=\"token operator\">:=</span> time<span class=\"token punctuation\">.</span><span class=\"token function\">Now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token keyword\">return</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%02d%02d%02d%02d%02d%02d\"</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">Year</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">int</span><span class=\"token punctuation\">(</span>now<span class=\"token punctuation\">.</span><span class=\"token function\">Month</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\tnow<span class=\"token punctuation\">.</span><span class=\"token function\">Day</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">Hour</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">Minute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> now<span class=\"token punctuation\">.</span><span class=\"token function\">Second</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">handleClient</span><span class=\"token punctuation\">(</span>conn <span class=\"token operator\">*</span>net<span class=\"token punctuation\">.</span>TCPConn<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>\t<span class=\"token keyword\">var</span> buf <span class=\"token punctuation\">[</span><span class=\"token number\">256</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>\t<span class=\"token keyword\">var</span> imageData <span class=\"token punctuation\">[</span><span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\t\tn<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"------------------------receive bytes--------------------\"</span><span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">,</span> <span class=\"token function\">string</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t\tsize<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> strconv<span class=\"token punctuation\">.</span><span class=\"token function\">Atoi</span><span class=\"token punctuation\">(</span><span class=\"token function\">string</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"------------------------file size--------------------\"</span><span class=\"token punctuation\">,</span> size<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>\t\ti <span class=\"token operator\">:=</span> <span class=\"token number\">0</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>\t\t<span class=\"token keyword\">for</span> i <span class=\"token operator\">&lt;</span> size <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>\t\t\tn<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">Read</span><span class=\"token punctuation\">(</span>imageData<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>\t\t\ti <span class=\"token operator\">+=</span> n</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>\t\tencodedStr <span class=\"token operator\">:=</span> hex<span class=\"token punctuation\">.</span><span class=\"token function\">EncodeToString</span><span class=\"token punctuation\">(</span>imageData<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"------------------------received bytes--------------------\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>encodedStr<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t\timgName <span class=\"token operator\">:=</span> fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s.jpg\"</span><span class=\"token punctuation\">,</span> <span class=\"token function\">GetDetailTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>\t\t<span class=\"token function\">byte2image</span><span class=\"token punctuation\">(</span>imageData<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> imgName<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">byte2image</span><span class=\"token punctuation\">(</span>b <span class=\"token punctuation\">[</span><span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">byte</span><span class=\"token punctuation\">,</span> n <span class=\"token builtin\">int</span><span class=\"token punctuation\">,</span> path <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\tfp<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> os<span class=\"token punctuation\">.</span><span class=\"token function\">Create</span><span class=\"token punctuation\">(</span>path<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>\t\t<span class=\"token keyword\">return</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>\t<span class=\"token keyword\">defer</span> fp<span class=\"token punctuation\">.</span><span class=\"token function\">Close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>\tbuf <span class=\"token operator\">:=</span> <span class=\"token function\">new</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">.</span>Buffer<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>\tbinary<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> binary<span class=\"token punctuation\">.</span>LittleEndian<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>\tfp<span class=\"token punctuation\">.</span><span class=\"token function\">Write</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">.</span><span class=\"token function\">Bytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>\taddress <span class=\"token operator\">:=</span> net<span class=\"token punctuation\">.</span>TCPAddr<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>\t\tIP<span class=\"token punctuation\">:</span>   net<span class=\"token punctuation\">.</span><span class=\"token function\">ParseIP</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"0.0.0.0\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 把字符串 IP 地址转换为 net.IP 类型</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>\t\tPort<span class=\"token punctuation\">:</span> <span class=\"token number\">9999</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"v2.0 server listen at \"</span><span class=\"token punctuation\">,</span> address<span class=\"token punctuation\">.</span>IP<span class=\"token punctuation\">,</span> address<span class=\"token punctuation\">.</span>Port<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\tlistener<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> net<span class=\"token punctuation\">.</span><span class=\"token function\">ListenTCP</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp4\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>address<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 创建 TCP4 服务器端监听器</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>\t\tlog<span class=\"token punctuation\">.</span><span class=\"token function\">Fatal</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token comment\">// Println + os.Exit(1)</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>\t\tconn<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> listener<span class=\"token punctuation\">.</span><span class=\"token function\">AcceptTCP</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>\t\t\tlog<span class=\"token punctuation\">.</span><span class=\"token function\">Fatal</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 错误直接退出</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>\t\tfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"remote address:\"</span><span class=\"token punctuation\">,</span> conn<span class=\"token punctuation\">.</span><span class=\"token function\">RemoteAddr</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>\t\t<span class=\"token comment\">// go echo(conn)</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>\t\t<span class=\"token keyword\">go</span> <span class=\"token function\">handleClient</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>编写完成之后，可以通过在当前目录下运行如下命令将代码打包成 Linux 可执行文件</p>\n<pre><code>SET CGO_ENABLED=0\nSET GOOS=linux\nSET GOARCH=amd64\ngo build main.go\n</code></pre>\n<p>这样就可以在当前目录下生成  <code>main</code>  可执行文件了，这也是我喜欢 go 的原因，同样的代码，可以方便的打包成 windows 可执行文件和 linux 可执行文件，十分的方便</p>\n<p>将打包生成的  <code>main</code>  文件传输到云服务器上，然后执行，TCP 服务器端代码就运行起来了，记得开放云服务器防火墙的对应端口</p>\n<p>接下来只要保证 TCP 客户端代码里的 ip 地址和端口正确，照片就可以顺利的上传到云服务器上，然后保存到可执行文件的目录下了～</p>\n<p>如果这篇文件对你有帮助，记得给博主点个赞支持一下呀 (✿◡‿◡)</p>\n",
            "tags": [
                "硬件修炼手册",
                "物联网",
                "IoT",
                "Air724UG"
            ]
        },
        {
            "id": "https://blog.aayu.today/hardware/iot/20211123/",
            "url": "https://blog.aayu.today/hardware/iot/20211123/",
            "title": "基于docker部署thingsboard+tb-gateway+emqx详细教程",
            "date_published": "2021-11-22T16:00:00.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\">#</a> 前言</h2>\n<p>这篇教程其实拖了好久了，十月份的时候经过连续几个晚上的踩坑，终于把整个流程跑通啦。但后面由于自己太懒了，一直没能抽时间把这篇教程记录下来，于是便拖到了现在 (。・ω・。)</p>\n<p>拒绝拖延，从我做起。记录下这篇博客，希望能帮到有需要的小伙伴～</p>\n<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<ul>\n<li>1 核 2G Centos 腾讯云服务器</li>\n<li>postgres 13.0 数据库</li>\n<li>thingsboard 3.2.1</li>\n<li>tb-gateway 最新版</li>\n<li>emqx 4.0</li>\n</ul>\n<p>这里需要注意一下，经过博主测试，1 核 2G 的配置是最低最低的极限配置，实际上，在该配置下用 docker 起四个体积不小的容器，打开网页已经能感受到明显的卡顿了。所以建议有条件的小伙伴升级到 2 核 4G 的配置比较好，这里博主就用 1 核 2G 的配置进行演示。</p>\n<h2 id=\"安装-postgres-数据库\"><a class=\"anchor\" href=\"#安装-postgres-数据库\">#</a> 安装 postgres 数据库</h2>\n<p>根据 <span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGluZ3Nib2FyZC5pby9kb2NzL3VzZXItZ3VpZGUvaW5zdGFsbC9kb2NrZXIv\">thingsboard</span> 的官方文档，thingsboard 的 docker 镜像里是带了 postgres 数据库的，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/58c52adcbc6a1.png\" alt=\"\" /></p>\n<p>因此理论上是不需要单独在安装 postgres 的。但博主在尝试的过程中，碰到了 postgres 的权限问题，即用 thingsboard 镜像里面自带的 postgres 数据库，数据库的初始化总是失败。导致后面 thingsboard 在启动过程中因为在数据库中找不到对应的表，直接就启动失败，退出了。</p>\n<p>在查询了很多资料后，在 stackoverflow 上找到了解决办法。</p>\n<p><a href=\"https://stackoverflow.com/questions/64659110/thingsboard-docker-container-deploy-resulting-in-psqlexception\">ThingsBoard Docker container deploy resulting in  <code>PSQLException</code> </a></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/00303b6c38237.png\" alt=\"\" /></p>\n<p>解决办法就是不用 thingsboard 镜像内自带的 postgres 数据库，在环境变量中将连接的数据库地址指向我们自己创建的 postgres 数据库。所以第一步就是用 docker 去创建一个 postgres 数据库。</p>\n<p>拉取指定版本的 postgres 镜像</p>\n<pre><code>docker pull postgres:13.0\n</code></pre>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/d88e21fc05841.png\" alt=\"\" /></p>\n<p>拉取完后查看镜像</p>\n<pre><code>docker images\n</code></pre>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/b973f640e2c68.png\" alt=\"\" /></p>\n<p>创建并启动容器</p>\n<pre><code>docker run --name postgres13 -e POSTGRES_PASSWORD=postgres -p 5432:5432 -v /root/thingsboard/pgdata:/var/lib/postgresql/data -d postgres:13.0\n</code></pre>\n<p>下面解释下这些参数的意思</p>\n<ul>\n<li>--name：将容器命名为一个好记的名字</li>\n<li>-e：设置环境变量。这里设置数据库的密码是 postgres</li>\n<li>-p：进行端口映射。左边是服务器的端口，右边是容器内的端口</li>\n<li>-v：进行目录映射。即将服务器的  <code>/root/thingsboard/pgdata</code>  与容器内部的  <code>/var/lib/postgresql/data</code>  的目录进行关联，而容器内部的那个目录即为储存数据的目录，这样就相当于将数据备份到本地了。同理，在服务器的对应目录下对数据库配置文件进行修改也能反映到</li>\n<li>-d：让容器后台运行</li>\n</ul>\n<p>注意：postgres 镜像默认的用户名为 postgres</p>\n<p>使用  <code>docker ps</code>  查看容器状态</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/3a3f5dec6862d.png\" alt=\"\" /></p>\n<p>进入服务器的  <code>/root/thingsboard/pgdata</code>  目录下，可以看到该目录下已经有数据了</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/fb9d896777e61.png\" alt=\"\" /></p>\n<p>下面可以在我们自己的电脑上用 pgadmin 工具连接一下云端的 postgres 数据库。注意服务器要放开 5432 端口哦</p>\n<p>创建一个 server</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/f603975019fdb.png\" alt=\"\" /></p>\n<p>填写数据库连接的参数，密码就是创建时设的  <code>postgres</code> ，点击确定后，没啥问题应该就能顺利连接上啦</p>\n<p>接下来，在 pgadmin 里创建一个  <code>thingsboard</code>  数据库，这样到时 thingsboard 镜像启动时，会连接这个数据库，对数据库进行初始化</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/0d22008b74c61.png\" alt=\"\" /></p>\n<p>输入数据库名称后，点击确定</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/62f02d88bbdcc.png\" alt=\"\" /></p>\n<p>做完这一步，数据库相关的工作就基本完成了，下一步就是启动 thingsboard 镜像了</p>\n<h2 id=\"启动-thingsboard-镜像\"><a class=\"anchor\" href=\"#启动-thingsboard-镜像\">#</a> 启动 thingsboard 镜像</h2>\n<p>根据 <span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGluZ3Nib2FyZC5pby9kb2NzL3VzZXItZ3VpZGUvaW5zdGFsbC9kb2NrZXIv\">thingsboard</span> 官方文档，想启动 thingsboard 镜像，除了需要安装  <code>docker</code> ，还需要再安装  <code>docker compose</code> ，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/323861c27c875.png\" alt=\"\" /></p>\n<p>根据 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmRvY2tlci5jb20vY29tcG9zZS9pbnN0YWxsLw==\">docker compose</span> 的文档，运行如下命令安装  <code>docker compose</code></p>\n<p>下载二进制可执行文件</p>\n<pre><code>sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose\n</code></pre>\n<p>赋予可执行权限</p>\n<pre><code>sudo chmod +x /usr/local/bin/docker-compose\n</code></pre>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/c2f692b43974b.png\" alt=\"\" /></p>\n<p>运行下列命令测试安装是否成功</p>\n<pre><code>docker-compose --version\n</code></pre>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/cab560336068a.png\" alt=\"\" /></p>\n<p>按照 <span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGluZ3Nib2FyZC5pby9kb2NzL3VzZXItZ3VpZGUvaW5zdGFsbC9kb2NrZXIv\">thingsboard</span> 官方文档，接下来就是创建一个  <code>docker-compose.yml</code>  文件了，这里该文件的内容和官方文档里的就有些差别了。因为官方文档里的默认是用内部的 postgres 数据库，经过博主的惨烈踩坑后，发现这种方式行不通，所以  <code>docker-compose.yml</code>  文件里的内容按照我的来编辑</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'2.2'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">mytb</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">restart</span><span class=\"token punctuation\">:</span> always</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"thingsboard/tb-postgres:3.2.1\"</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"8080:9090\"</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"1884:1883\"</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"7070:7070\"</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token string\">\"5683-5688:5683-5688/udp\"</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">-</span> TB_QUEUE_TYPE=in<span class=\"token punctuation\">-</span>memory</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>      <span class=\"token punctuation\">-</span> SPRING_DATASOURCE_URL=jdbc<span class=\"token punctuation\">:</span>postgresql<span class=\"token punctuation\">:</span>//xxx.xxx.xxx.xxx<span class=\"token punctuation\">:</span>5432/thingsboard</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token punctuation\">-</span> SPRING_DATASOURCE_USERNAME=postgres</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> SPRING_DATASOURCE_PASSWORD=postgres</pre></td></tr></table></figure><p>可以看到和官方文档里的主要区别就是在环境变量里指定了外部 postgres 数据库的地址，注意把地址换成你自己云服务器的地址</p>\n<p>哦对，还有一个主要区别，注意到  <code>1884:1883</code>  了吗，官方文档里是  <code>1883:1883</code> ，这里和官方文档不一样是因为我后面还需要用 docker 启动  <code>emqx</code> ，而  <code>emqx</code>  也需要用 1883 端口，所以我这里把 thingsboard 的 1883 端口映射为服务器的 1884 端口，这里是一个重点哦～</p>\n<p>这里可以把  <code>docker-compose.yml</code>  文件放到  <code>/root/thingsboard/</code>  目录下，然后我们在该目录下运行</p>\n<pre><code>docker-compose pull\ndocker-compose up\n</code></pre>\n<p>来拉取镜像并启动镜像。</p>\n<p>这里我镜像指定的是  <code>3.2.1</code>  版本的，如果想用最新版的，可以把后面的  <code>3.2.1</code>  去掉，但最新版的可能会有新的问题，这里博主还没有去踩新坑</p>\n<p>数据库地址配置正确的话，可以在启动过程中看到正在初始化数据库</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/9167f67d019b3.png\" alt=\"\" /></p>\n<p>下图表示数据库初始化成功，数据库初始化成功的话，后面就应该不会有啥问题了</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/1a29962399803.png\" alt=\"\" /></p>\n<p>下图就是正常启动的输出日志</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/3d9270754b4d8.png\" alt=\"\" /></p>\n<p>在服务器的防火墙中放开  <code>8080</code> 、 <code>1884</code> 、 <code>7070</code> 、 <code>5683-5688</code>  这几个端口，然后再浏览器中访问  <code>ip地址:8080</code> ，就可以看到 thingsboard 的登陆界面了，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/7ad0b9414a80b.png\" alt=\"\" /></p>\n<p>官方文档也给出了默认的系统管理员账号和密码，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/b7919b724d8b1.png\" alt=\"\" /></p>\n<p>我们再打开 pgadmin，可以看到 thingsboard 数据库中已经多出了很多表，这些都是在数据库初始化时自动生成的</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/dd754882fd1ae.png\" alt=\"\" /></p>\n<p>至此，用 docker 启动 thingsboard 就成功啦～</p>\n<h2 id=\"安装-tb-gateway\"><a class=\"anchor\" href=\"#安装-tb-gateway\">#</a> 安装 tb-gateway</h2>\n<p>可以直接参考官方文档：<span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGluZ3Nib2FyZC5pby9kb2NzL2lvdC1nYXRld2F5L2luc3RhbGwvZG9ja2VyLWluc3RhbGxhdGlvbi8=\">Install ThingsBoard IoT Gateway using Docker.</span></p>\n<pre><code>docker run -it -v ~/.tb-gateway/logs:/thingsboard_gateway/logs -v ~/.tb-gateway/extensions:/thingsboard_gateway/extensions -v ~/.tb-gateway/config:/thingsboard_gateway/config --name tb-gateway --restart always thingsboard/tb-gateway\n</code></pre>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/77009dd8d27c3.png\" alt=\"\" /></p>\n<p>通过  <code>-v</code>  挂载目录后，就可以直接在  <code>~/.tb-gateway/config</code>  修改 tb-gateway 的配置文件了，非常的方便</p>\n<p>接下来可以参考 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vaW90c2Nob29sL3AvMTMwNjUzMzAuaHRtbA==\">Thingsboard 3.0 通过 tb-gateway 网关接入 MQTT 设备教程</span> 这篇博客对  <code>tb-gateway</code>  进行配置</p>\n<h2 id=\"安装-emqx\"><a class=\"anchor\" href=\"#安装-emqx\">#</a> 安装 emqx</h2>\n<p>这个好像也没啥好写的，直接看官方文档就行了：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLmVtcXguY24vYnJva2VyL3Y0LjMvZ2V0dGluZy1zdGFydGVkL2luc3RhbGwuaHRtbCMlRTklODAlOUElRTglQkYlODctZG9ja2VyLSVFOCVCRiU5MCVFOCVBMSU4Qy0lRTUlOEMlODUlRTUlOTAlQUIlRTclQUUlODAlRTUlOEQlOTUlRTclOUElODQtZG9ja2VyLWNvbXBvc2UtJUU5JTlCJTg2JUU3JUJFJUE0\">通过 Docker 运行 (包含简单的 docker-compose 集群)</span></p>\n<pre><code>docker pull emqx/emqx:v4.0.0\n$ docker run -d --name emqx -p 1883:1883 -p 8081:8081 -p 8083:8083 -p 8883:8883 -p 8084:8084 -p 18083:18083 emqx/emqx:v4.0.0\n</code></pre>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/523ff8f50352c.png\" alt=\"\" /></p>\n<p>注意在防火墙放开  <code>1883</code> 、 <code>8081</code> 、 <code>8083</code> 、 <code>8883</code> 、 <code>8084</code> 、 <code>18083</code>  这几个端口</p>\n<p>启动成功后，访问  <code>ip地址:18083</code> ，就可以看到 emqx 的界面了，如下图</p>\n<p>默认用户名是  <code>admin</code> ，密码是  <code>public</code></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/a8ff43b0eac3c.png\" alt=\"\" /></p>\n<p>剩下的就可以参考 <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vaW90c2Nob29sL3AvMTMwNjUzMzAuaHRtbA==\">Thingsboard 3.0 通过 tb-gateway 网关接入 MQTT 设备教程</span> 这篇博客接入 MQTT 设备啦</p>\n<p>教程写到这里就要结束啦，这篇教程浓缩了博主踩了好几个晚上的坑，都是博主的血和泪 555，如果对你们有帮助的话，记得点个赞支持一下博主呀 (✿◡‿◡)</p>\n<h2 id=\"参考文章\"><a class=\"anchor\" href=\"#参考文章\">#</a> 参考文章</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly90aGluZ3Nib2FyZC5pby9kb2NzL3VzZXItZ3VpZGUvaW5zdGFsbC9kb2NrZXIv\">Installing ThingsBoard using Docker (Linux or Mac OS)</span></li>\n<li><a href=\"https://stackoverflow.com/questions/64659110/thingsboard-docker-container-deploy-resulting-in-psqlexception\">ThingsBoard Docker container deploy resulting in  <code>PSQLException</code> </a></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vaW90c2Nob29sL3AvMTMwNjUzMzAuaHRtbA==\">Thingsboard 3.0 通过 tb-gateway 网关接入 MQTT 设备教程</span></li>\n</ul>\n",
            "tags": [
                "硬件修炼手册",
                "物联网",
                "Docker",
                "IoT",
                "ThingsBoard",
                "TB-Gateway",
                "EMQX"
            ]
        },
        {
            "id": "https://blog.aayu.today/skill/environment-configuration/20211016/",
            "url": "https://blog.aayu.today/skill/environment-configuration/20211016/",
            "title": "R语言和RStudio开发环境的下载与安装",
            "date_published": "2021-10-15T16:00:00.000Z",
            "content_html": "<h2 id=\"r的下载和安装\"><a class=\"anchor\" href=\"#r的下载和安装\">#</a> R 的下载和安装</h2>\n<p>进入官网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuci1wcm9qZWN0Lm9yZy8=\">https://www.r-project.org/</span></p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/1122ec109808a.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/835334d0072bf.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/e6d40cdeb884b.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/4b251d20f50a1.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/d4ec5939c18b1.png\" alt=\"\" /></p>\n<p>下载完成后双击运行安装包，注意这里全部点击下一步默认即可，不要更改安装路径，后面会省很多麻烦～</p>\n<h2 id=\"rstudio的下载与安装\"><a class=\"anchor\" href=\"#rstudio的下载与安装\">#</a> RStudio 的下载与安装</h2>\n<p>RStudio 是 R 语言的集成开发环境，我们首先进入官网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cucnN0dWRpby5jb20v\">https://www.rstudio.com/</span></p>\n<p>注意，该网址对网络有些要求，如果发现该官网网址打不开，就用我的百度网盘安装包吧</p>\n<p>链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMXkwUHFhNk1GM1htLWNCMXNhaldBNHc=\">https://pan.baidu.com/s/1y0Pqa6MF3Xm-cB1sajWA4w</span><br />\n 提取码：90cw</p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/0a562617f040b.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/b56edb873f7c2.png\" alt=\"\" /></p>\n<p>下载完成后右键选择以 <code>管理员身份</code> 运行安装包，也是全部点击下一步默认即可，最后，RStudio 就安装成功啦</p>\n<p>安装完成后打开 RStudio，就能看到一个精美的 R 语言集成开发环境啦</p>\n<p><img data-src=\"http://image.aayu.today/2022/02/27/376dc4ec1d4e1.png\" alt=\"\" /></p>\n",
            "tags": [
                "不看会后悔的实用技巧分享",
                "环境配置",
                "R",
                "RStudio"
            ]
        },
        {
            "id": "https://blog.aayu.today/hardware/bear-pi/20211014/",
            "url": "https://blog.aayu.today/hardware/bear-pi/20211014/",
            "title": "小熊派-串口读取RS485输出的土壤七合一传感器数据（基于STM32CubeMX）",
            "date_published": "2021-10-13T16:00:00.000Z",
            "content_html": "<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<ul>\n<li>JRE（Java Runtime Environment）</li>\n<li>STM32CubeMX v6.3.0</li>\n<li>HAL 库 L4 v1.7.0</li>\n<li>Keil5-MDK</li>\n</ul>\n<p>环境搭建参考：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU5OTM5MC9hcnRpY2xlL2RldGFpbHMvMTA2ODYzOTI5\">STM32CubeMX 学习记录 -- 安装配置与使用</span></p>\n<p>如果不想去官网下，也可以从我的百度云分享里下载 STM32CubeMX 和 HAL 库</p>\n<p>链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMTBNS0dLUE5Rckl4Wm51TVp2Vktxa2c=\">https://pan.baidu.com/s/10MKGKPNQrIxZnuMZvVKqkg</span><br />\n 提取码：zjor</p>\n<h2 id=\"硬件\"><a class=\"anchor\" href=\"#硬件\">#</a> 硬件</h2>\n<ul>\n<li>小熊派开发板</li>\n</ul>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/caa39a90752c8.png\" alt=\"\" /></p>\n<ul>\n<li>土壤七合一传感器（水分、温度、电导率、氮磷钾、PH 值）</li>\n</ul>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/4813d00d339f7.png\" alt=\"\" /></p>\n<ul>\n<li>RS485 转 TTL 模块</li>\n</ul>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/77b8bc00db7c2.png\" alt=\"\" /></p>\n<h2 id=\"接线图\"><a class=\"anchor\" href=\"#接线图\">#</a> 接线图</h2>\n<ul>\n<li>小熊派的  <code>5v</code>  电源接土壤传感器的  <code>电源正</code></li>\n<li>小熊派的  <code>GND</code>  接土壤传感器的  <code>电源地</code></li>\n<li>小熊派的  <code>3.3v</code>  电源接转接模块的  <code>VCC</code></li>\n<li>小熊派的  <code>GND</code>  接转接模块的  <code>GND</code></li>\n<li>小熊派的  <code>UART2_TX</code>  接转接模块的  <code>TXD</code></li>\n<li>小熊派的  <code>UART2_RX</code>  接转接模块的  <code>RXD</code></li>\n<li>转接模块的  <code>A+</code>  接土壤传感器的  <code>485-A</code></li>\n<li>转接模块的  <code>B-</code>  接土壤传感器的  <code>485-B</code></li>\n</ul>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/33d355271d104.png\" alt=\"\" /></p>\n<h2 id=\"创建工程\"><a class=\"anchor\" href=\"#创建工程\">#</a> 创建工程</h2>\n<p>打开 STM32CubeMX，选择新建一个工程，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/5f8fd595babc3.png\" alt=\"\" /></p>\n<p>在输入框中输入  <code>stm32l431rc</code> ，选中，然后双击选择中间  <code>LQFP64</code>  的这款，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/a0567b1553f35.png\" alt=\"\" /></p>\n<p>查看原理图， <code>KEY1</code>  按键对应的引脚为  <code>PB2</code> ，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/cbaf5779e0697.png\" alt=\"\" /></p>\n<p>在 STM32CubeMX 中选择  <code>PB2</code>  引脚输出模式为  <code>GPIO_input</code></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/a705d5e9e12e4.png\" alt=\"\" /></p>\n<p>设置  <code>PB2</code>  输出方式和别名，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/065ffc9bc1f5f.png\" alt=\"\" /></p>\n<p>设置  <code>UART1</code>  为异步输出，该串口是用来和 PC 端进行通信，波特率就用默认的 115200，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/d98814b2d76e3.png\" alt=\"\" /></p>\n<p>设置  <code>UART2</code>  为异步输出，该串口用来和土壤传感器进行通信，我们上面的硬件接线也是使用的是  <code>UART2</code>  串口。土壤传感器的波特率为 9600，所以工程里该串口波特率设置为 9600，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/faaccfe8db78e.png\" alt=\"\" /></p>\n<p>时钟使用内部默认时钟，设置为最高 80MHz</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/f300e7fd8b454.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/c1039726db46a.png\" alt=\"\" /></p>\n<p>最后配置生成工程设置，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/c91261592128a.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/6766e875243ac.png\" alt=\"\" /></p>\n<p>最后选择右上角的  <code>GENERATE CODE</code> ，即可完成工程的创建</p>\n<h2 id=\"在-keil5-mdk-中编写代码\"><a class=\"anchor\" href=\"#在-keil5-mdk-中编写代码\">#</a> 在 Keil5-MDK 中编写代码</h2>\n<p>进入  <code>MDK-ARM</code>  目录，打开工程，在  <code>usart.c</code>  中编写如下代码</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* USER CODE BEGIN 1 */</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">int</span> <span class=\"token function\">fputc</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> ch<span class=\"token punctuation\">,</span> FILE <span class=\"token operator\">*</span>file<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t<span class=\"token class-name\">uint8_t</span> temp<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>ch<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token function\">HAL_UART_Transmit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>huart1<span class=\"token punctuation\">,</span> temp<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token keyword\">return</span> HAL_OK<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">/* USER CODE END 1 */</span></pre></td></tr></table></figure><p>并在该文件头部添加头文件</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* USER CODE BEGIN 0 */</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"stdio.h\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/* USER CODE END 0 */</span></pre></td></tr></table></figure><p>重写  <code>fputc</code>  可以将  <code>printf</code>  函数的输出重定向到  <code>uart1</code>  串口上，就可以通过串口助手显示出来</p>\n<p>在  <code>main.c</code>  中，首先添加头文件</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* USER CODE BEGIN Includes */</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"stdio.h\"</span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/* USER CODE END Includes */</span></pre></td></tr></table></figure><p>然后在 main 函数的 while 循环中编写如下代码</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/* USER CODE BEGIN 3 */</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 如果检测到 KEY1 按下</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">HAL_GPIO_ReadPin</span><span class=\"token punctuation\">(</span>KEY1_GPIO_Port<span class=\"token punctuation\">,</span> KEY1_Pin<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> GPIO_PIN_RESET<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">// 按键去抖</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token function\">HAL_Delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">HAL_GPIO_ReadPin</span><span class=\"token punctuation\">(</span>KEY1_GPIO_Port<span class=\"token punctuation\">,</span> KEY1_Pin<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> GPIO_PIN_RESET<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token function\">HAL_Delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">// 发送问询帧</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> askData<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token number\">0x01</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x03</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x04</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x44</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x09</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token function\">HAL_UART_Transmit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>huart2<span class=\"token punctuation\">,</span> askData<span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">// 接收应答帧</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token class-name\">uint8_t</span> result<span class=\"token punctuation\">[</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token function\">HAL_UART_Receive</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>huart2<span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0xff</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">13</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" %x \"</span><span class=\"token punctuation\">,</span> result<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>这里的  <code>HAL_UART_Transmit</code>  和  <code>HAL_UART_Receive</code>  都是用的  <code>uart2</code>  串口，向我们的土壤传感器发送和接收数据。</p>\n<p>查阅土壤传感器的用户手册，想要获取数据，要先发送一个问询帧，如下</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/15fa5332a406f.png\" alt=\"\" /></p>\n<p>因此，我们根据用户手册里的示例，向  <code>uart2</code>  串口发送一个如代码所示的问询帧，然后接收返回来的应答帧，最后输出到串口助手上就好啦</p>\n<h2 id=\"编译-烧录程序\"><a class=\"anchor\" href=\"#编译-烧录程序\">#</a> 编译、烧录程序</h2>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/b21f00d70afc2.png\" alt=\"\" /></p>\n<p>勾选  <code>MicroLIB</code>  库很重要，不然会无法向串口助手输出数据</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/5c313ed408192.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/19985646ceb4a.png\" alt=\"\" /></p>\n<p>勾选  <code>reset and run</code>  可以让程序烧录完成后自动运行。</p>\n<p>设置完成后点击确定，OK</p>\n<p>点击编译，然后烧录，下图所示表示烧录成功</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/57aa8fb18a837.png\" alt=\"\" /></p>\n<p>打开串口助手，这里我用的是 QCOM。打开端口，然后按下小熊派的  <code>KEY1</code>  按键，可以看到串口助手打印出了应答帧的信息，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/4a8bd2d0673be.png\" alt=\"\" /></p>\n<p>根据土壤传感器的用户手册，可以解析出温度数据为： <code>0x01 0x03（十六进制） = 259（十进制）</code> ，所以当前温度为 25.9 ℃</p>\n",
            "tags": [
                "硬件修炼手册",
                "小熊派",
                "BearPi",
                "STM32CubeMX",
                "RS485"
            ]
        },
        {
            "id": "https://blog.aayu.today/hardware/bear-pi/20211010/",
            "url": "https://blog.aayu.today/hardware/bear-pi/20211010/",
            "title": "小熊派-按键控制LED灯亮灭（基于STM32CubeMX）",
            "date_published": "2021-10-09T16:00:00.000Z",
            "content_html": "<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<ul>\n<li>JRE（Java Runtime Environment）</li>\n<li>STM32CubeMX v6.3.0</li>\n<li>HAL 库 L4 v1.7.0</li>\n<li>Keil5-MDK</li>\n</ul>\n<p>环境搭建参考：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU5OTM5MC9hcnRpY2xlL2RldGFpbHMvMTA2ODYzOTI5\">STM32CubeMX 学习记录 -- 安装配置与使用</span></p>\n<p>如果不想去官网下，也可以从我的百度云分享里下载 STM32CubeMX 和 HAL 库</p>\n<p>链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMTBNS0dLUE5Rckl4Wm51TVp2Vktxa2c=\">https://pan.baidu.com/s/10MKGKPNQrIxZnuMZvVKqkg</span><br />\n 提取码：zjor</p>\n<h2 id=\"创建工程\"><a class=\"anchor\" href=\"#创建工程\">#</a> 创建工程</h2>\n<p>打开 STM32CubeMX，选择新建一个工程，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/5f8fd595babc3.png\" alt=\"\" /></p>\n<p>在输入框中输入  <code>stm32l431rc</code> ，选中，然后双击选择中间  <code>LQFP64</code>  的这款，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/a0567b1553f35.png\" alt=\"\" /></p>\n<p>配置时钟源，这里选择外部高速时钟，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/ee8ec2d56a83d.png\" alt=\"\" /></p>\n<p>外设引脚对应表</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">MCU 引脚</th>\n<th style=\"text-align:center\">引脚标注名</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">PC13</td>\n<td style=\"text-align:center\">LED</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">PB2</td>\n<td style=\"text-align:center\">KEY1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">PB3</td>\n<td style=\"text-align:center\">KEY2</td>\n</tr>\n</tbody>\n</table>\n<p>按键原理图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/812e52e63ab9b.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/cbaf5779e0697.png\" alt=\"\" /></p>\n<p>配置时钟树。STM32L4 的最高主频可达到 80M，使  <code>HCLK = 80Mhz</code> ，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/5212bdbc0b02e.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/3db26a836599c.png\" alt=\"\" /></p>\n<p>配置 LED GPIO 引脚，并修改用户标签名（相当于取另一个新名字），如下图<br />\n<img data-src=\"http://image.aayu.today/2022/01/16/f0dc3bab38ca1.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/3f2398316a609.png\" alt=\"\" /></p>\n<p>配置 PB2 和 PB3 设置成上拉输入，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/fd84528e9ffd2.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/dbec4b0aa98c0.png\" alt=\"\" /></p>\n<p>最后配置生成工程设置，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/a28f464dd80d1.png\" alt=\"\" /></p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/6766e875243ac.png\" alt=\"\" /></p>\n<p>最后选择右上角的  <code>GENERATE CODE</code> ，即可完成工程的创建</p>\n<h2 id=\"在-keil5-mdk-中编写代码\"><a class=\"anchor\" href=\"#在-keil5-mdk-中编写代码\">#</a> 在 Keil5-MDK 中编写代码</h2>\n<p>进入  <code>MDK-ARM</code>  目录，打开工程，在  <code>main.c</code>  中编写如下代码</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t<span class=\"token comment\">/* USER CODE END WHILE */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t\t\t</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">HAL_GPIO_ReadPin</span><span class=\"token punctuation\">(</span>KEY1_GPIO_Port<span class=\"token punctuation\">,</span> KEY1_Pin<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t\t\t<span class=\"token function\">HAL_Delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\t\t\t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">HAL_GPIO_ReadPin</span><span class=\"token punctuation\">(</span>KEY1_GPIO_Port<span class=\"token punctuation\">,</span> KEY1_Pin<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t\t<span class=\"token function\">HAL_Delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t\t\t</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t\t\t<span class=\"token comment\">// filp LED status</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t\t<span class=\"token function\">HAL_GPIO_TogglePin</span><span class=\"token punctuation\">(</span>LED_GPIO_Port<span class=\"token punctuation\">,</span> LED_Pin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t\t</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t\t\t<span class=\"token comment\">// the above code is equivalent to the following</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">//\t\t\tif (HAL_GPIO_ReadPin(LED_GPIO_Port, LED_Pin) == 0) &#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">//\t\t\t\tHAL_GPIO_WritePin(LED_GPIO_Port, LED_Pin, 1);</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">//\t\t\t&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">//\t\t\telse &#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">//\t\t\t\tHAL_GPIO_WritePin(LED_GPIO_Port, LED_Pin, 0);</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">//\t\t\t&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>点击编译和烧录，烧录配置参考：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0FwcGxlX0NvY28vYXJ0aWNsZS9kZXRhaWxzLzEyMDY4MTk2Ng==\">小熊派开发笔记 - 点亮 LED 灯（基于 STM32CubeMX）</span></p>\n<p>烧录成功如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/abd3691d8df89.png\" alt=\"\" /></p>\n<h2 id=\"实验结果\"><a class=\"anchor\" href=\"#实验结果\">#</a> 实验结果</h2>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/fb76e62cdc2e7.gif\" alt=\"\" /></p>\n",
            "tags": [
                "硬件修炼手册",
                "小熊派",
                "BearPi",
                "STM32CubeMX"
            ]
        },
        {
            "id": "https://blog.aayu.today/hardware/bear-pi/20211009/",
            "url": "https://blog.aayu.today/hardware/bear-pi/20211009/",
            "title": "小熊派-点亮LED灯（基于STM32CubeMX）",
            "date_published": "2021-10-08T16:00:00.000Z",
            "content_html": "<h2 id=\"环境\"><a class=\"anchor\" href=\"#环境\">#</a> 环境</h2>\n<ul>\n<li>JRE（Java Runtime Environment）</li>\n<li>STM32CubeMX v6.3.0</li>\n<li>HAL 库 L4 v1.7.0</li>\n<li>Keil5-MDK</li>\n</ul>\n<p>环境搭建参考：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU5OTM5MC9hcnRpY2xlL2RldGFpbHMvMTA2ODYzOTI5\">STM32CubeMX 学习记录 -- 安装配置与使用</span></p>\n<p>如果不想去官网下，也可以从我的百度云分享里下载 STM32CubeMX 和 HAL 库</p>\n<p>链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMTBNS0dLUE5Rckl4Wm51TVp2Vktxa2c=\">https://pan.baidu.com/s/10MKGKPNQrIxZnuMZvVKqkg</span><br />\n 提取码：zjor</p>\n<h2 id=\"创建工程\"><a class=\"anchor\" href=\"#创建工程\">#</a> 创建工程</h2>\n<p>打开 STM32CubeMX，选择新建一个工程，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/5f8fd595babc3.png\" alt=\"\" /></p>\n<p>在输入框中输入  <code>stm32l431rc</code> ，选中，然后双击选择中间  <code>LQFP64</code>  的这款，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/a0567b1553f35.png\" alt=\"\" /></p>\n<p>配置时钟源，这里选择外部高速时钟，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/ee8ec2d56a83d.png\" alt=\"\" /></p>\n<p>配置 GPIO 引脚，在原理图上查看 LED 灯的连接情况如下</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/93df37e638255.png\" alt=\"\" /></p>\n<p>所以在 STM32CubeMX 中选择配置 PC13 引脚，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/f0dc3bab38ca1.png\" alt=\"\" /></p>\n<p>配置时钟树，选择 HSE，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/aac1ceb8095c5.png\" alt=\"\" /></p>\n<p>配置工程，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/3f83bfc9292bc.png\" alt=\"\" /></p>\n<p>最后选择右上角的  <code>GENERATE CODE</code> ，即可完成工程的创建</p>\n<h2 id=\"在-keil5-mdk-中编写代码\"><a class=\"anchor\" href=\"#在-keil5-mdk-中编写代码\">#</a> 在 Keil5-MDK 中编写代码</h2>\n<p>STM32CubeMX 生成的代码目录如下</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/25616712663e9.png\" alt=\"\" /></p>\n<p>进入  <code>MDK-ARM</code>  目录，打开工程，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/d1c6d04a00f19.png\" alt=\"\" /></p>\n<p>在 main.c 中编写如下代码</p>\n<figure class=\"highlight c\"><figcaption data-lang=\"c\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token comment\">/* USER CODE END WHILE */</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\t  </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>\t<span class=\"token function\">HAL_Delay</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token function\">HAL_GPIO_TogglePin</span><span class=\"token punctuation\">(</span>GPIOC<span class=\"token punctuation\">,</span> GPIO_PIN_13<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token comment\">/* USER CODE BEGIN 3 */</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>然后编译整个工程</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/31d2227bc3f6f.png\" alt=\"\" /></p>\n<p>最后进行下载设置。点击菜单栏的  <code>Options for Target</code> ，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/324bf0eb63d45.png\" alt=\"\" /></p>\n<p>选择 Debug，进行 ST-Link 配置，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/3e5adeac0cbd7.png\" alt=\"\" /></p>\n<p>选择  <code>reset and fun</code> ，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/82a8a2a062b8c.png\" alt=\"\" /></p>\n<p>点击确定，OK</p>\n<p>最后点击下载，如下图</p>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/64f1e7a9f0327.png\" alt=\"\" /></p>\n<h2 id=\"实验结果\"><a class=\"anchor\" href=\"#实验结果\">#</a> 实验结果</h2>\n<p><img data-src=\"http://image.aayu.today/2022/01/16/5094980fb0381.gif\" alt=\"\" /></p>\n",
            "tags": [
                "硬件修炼手册",
                "小熊派",
                "BearPi",
                "STM32CubeMX"
            ]
        }
    ]
}